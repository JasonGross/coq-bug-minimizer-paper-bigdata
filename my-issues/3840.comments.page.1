[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527899","html_url":"https://github.com/coq/coq/issues/3840#issuecomment-337527899","issue_url":"https://api.github.com/repos/coq/coq/issues/3840","id":337527899,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyNzg5OQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-07T07:53:13Z","updated_at":"2017-10-18T09:42:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nGoal exists x : option Type, match x with Some y => True | None => False end.\n  eexists.\n  refine (_ : match Some _ with None => _ | _ => _ end).\n\n(* Anomaly: Uncaught exception Not_found. Please report. *)\n\nThis only happens in 8.4, though the behavior in trunk is unsatisfactory in its own way, since what I'm really trying to do is the equivalent of [instantiate (1 := Some _)].  (In trunk (f839f718fc6271aeb014c9cb5abdf9106b1c26be), it first reduces the match, and then unifies the [Some] branch with the preexisting goal.  I think it should instead first try syntactic unification, and only reduce to whnf if that fails.)\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527900","html_url":"https://github.com/coq/coq/issues/3840#issuecomment-337527900","issue_url":"https://api.github.com/repos/coq/coq/issues/3840","id":337527900,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyNzkwMA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-07T19:02:39Z","updated_at":"2017-10-18T09:42:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nI highly doubt that the 8.4 refine will be ever fixed, it was a real mess. As for the trunk behaviour, why don't you just use the [instantiate] tactic you mention? The [refine] tactic does not seem fit to do what you intended to...\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527901","html_url":"https://github.com/coq/coq/issues/3840#issuecomment-337527901","issue_url":"https://api.github.com/repos/coq/coq/issues/3840","id":337527901,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyNzkwMQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-07T21:49:48Z","updated_at":"2017-10-18T09:42:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nBecause [instantiate] uses numbers, and I want to use shape, e.g., for tactic scripts.\n\nI could do something like\n\nGoal exists x : option Type, match x with Some y => True | None => False end.\n  eexists.\n  match goal with\n    | [ |- match ?x with None => False | _ => _ end ]\n      => is_evar x; refine (let k := eq_refl : x = Some _ in _)\n  end.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527902","html_url":"https://github.com/coq/coq/issues/3840#issuecomment-337527902","issue_url":"https://api.github.com/repos/coq/coq/issues/3840","id":337527902,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyNzkwMg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-08T09:29:33Z","updated_at":"2017-10-18T09:42:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @aspiwack\n\nAs Pierre-Marie sort of implied, one of the reason that the new implementation of refine exists is to fix many bugs of the previous implementation (which was quite ad hoc). I don't think anyone is willing to spend the time for a fix in v8.4.\n\nFor the trunk version, I'm afraid I can't do much: unification is performed by the type inference mechanism (pretyper). It follows many heuristics which are bound not to be satisfactory in every cases.\n\nI agree that the use case you present needs a solution. But I don't have a good one just yet.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527903","html_url":"https://github.com/coq/coq/issues/3840#issuecomment-337527903","issue_url":"https://api.github.com/repos/coq/coq/issues/3840","id":337527903,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyNzkwMw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-08T11:42:58Z","updated_at":"2017-10-18T09:42:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nHi Jason,\n\nBy the way, there is no more an uncaught \"Not_found\" in 8.4pl5... (though the cast has no interesting effect).\n\nPlease refer to this version to report bugs on 8.4!\n\nHugo\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337527903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]