[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534526","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534526","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534526,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUyNg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-05T21:21:17Z","updated_at":"2017-10-18T10:01:37Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nIn 8.4, this code works.  In ff58f3d68369e0e535a98326e53de782ff460096, it does not (gives me 2 = 3).\n\nGoal forall x : nat, x = 1 -> x = 2 -> x = 3.\n  intros.\n  subst.\n  match goal with\n    | [ |- 1 = 3 ] => idtac\n  end.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534527","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534527","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534527,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUyNw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T05:21:26Z","updated_at":"2017-10-18T10:01:37Z","author_association":"CONTRIBUTOR","body":"Comment author: @silene\n\nSomehow related (since presumably caused by the same commit), the following script works in 8.4 but not in 8.5.\n\nGoal let a := 1 in 0 = a -> False.\n  intros a H.\n  subst.\n  discriminate.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534528","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534528","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534528,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUyOA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T07:48:37Z","updated_at":"2017-10-18T10:01:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nHi,\n\nIn 8.4, subst was implemented as follows:\n\n- collect within all hyps, from the oldest to the most recent, all variables x appearing in equations of the form \"x=t\" with t not x or \"u=x\" with u not a variable\n- apply \"subst x\" for all of these variables in the collected order\n\nThe drawback was that in a configuration like \"x=y, x=u\", y was not collected and x=u, after being turned to y=u, not used, as shown in [BZ#4214](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%234214%22).\n\nAnother peculiar behavior is the one shown by Guillaume. In a configuration like \"x:=t, x=u\", x was unfolded everywhere to t (because this is the effect of \"subst x\"), but in a configuration like \"x:=t, phi(x)=u\" it was not (because x not detected as substitutable in the first phase).\n\nWhat to do in Guillaume's example, I don't know. Morally, we should substitute x by u, but this is impossible, so, indeed, we should instead substitute x by t, at least in x=u. I guess conservativity would force us to support Guillaume's example, even if subst is doing nothing on e.g. x:=t |- x=u.\n\nAbout the order. Jason shows a bug in what I did, but that's just a List.rev.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534530","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534530","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534530,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUzMA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T08:51:12Z","updated_at":"2017-10-18T10:01:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @aspiwack\n\nI think binders of the form `x:=a` should be collected by subst, since `subst x` works on them. Absence of this behaviour has always been puzzling to me.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534531","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534531","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534531,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUzMQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T08:55:59Z","updated_at":"2017-10-18T10:01:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @silene\n\nPerhaps I am mistaken, but I don't think subst could make a goal unprovable before. As shown on my example, it can now happen. I believe it is important to restore the old property.\n\nI don't know what it means for my testcase. (By the way, it is a reduced testcase from the failure of FingerTree in the bench.) But I am pretty sure removing \"x = foo\" from the context while x is not universally quantified is always wrong.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534534","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534534","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534534,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUzNA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T09:23:28Z","updated_at":"2017-10-18T10:01:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nGuillaume, it is clear that we don't want your example to remove information (this is a bug of my new implementation).\n\nTreatment of let-in is however not very regular yet. Consider e.g. in 8.4:\n\nGoal forall x, let y:=1 in x=y -> x=y.\nintros.\nsubst.\n(*\n  y := 1 : nat\n  ============================\n   y = y\n*)\n\nGoal forall x, let y:=1 in y=x -> x=y.\nintros.\nsubst.\n(*\n  x : nat\n  H : 1 = x\n  ============================\n   x = 1\n*)\n\nIn 8.4, an x:=t is unfolded iff it appears on the lhs of an equation x=t (t not x) or t=x (t not a variable), which is even not stable by symmetry. So, between the following criteria:\n\n1. unfold all let-ins\n2. unfold no let-ins\n3. the above 8.4 criterion\n4. unfolds x:=t iff either x=u or u=x with u not x occurs in hyps (i.e. improved 8.4 criterion)\n\nwhat to choose?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534535","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534535","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534535,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUzNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T09:28:23Z","updated_at":"2017-10-18T10:01:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @silene\n\nIf we don't care about backward-compatibility (and given how irregular subst is, I don't think we care much here), my preference goes to \"unfold all let-ins\". Indeed, subst should behave identically for \"forall x, x = foo -> ...\" and \"let x := foo in ...\".\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534536","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534536","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534536,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUzNg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T16:42:11Z","updated_at":"2017-10-18T10:01:39Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nI'd like to weigh in on the side of mostly preserving backwards compatibility, or perhaps having a [Set]ting that lets you switch from option 1 to option 2 (since option 2 is closer to the 8.4 behavior).  It's not too big an issue, though, since I think I can replicate the old behavior with something like\n\nLtac subst' :=\n  repeat match goal with\n           | [ H : ?x = ?y |- _ ] => is_var x; subst x\n           | [ H : ?x = ?y |- _ ] => is_var y; subst y\n         end.\n\n(or possibly [match reverse goal with ...])\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534539","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534539","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534539,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDUzOQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-06T17:03:02Z","updated_at":"2017-10-18T10:01:39Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nActually, and naively, I would say that let-in are deliberately used for the purpose of abbreviating big expressions, so applying subst would revert their role as abbreviations. So, I'd like to see examples of situations where when one wants subst to unfolds local definitions.\n\nBy the way, I discovered another strange behavior which I propose to fix:\n\nGoal forall x y, x = S y -> y = S x -> x = y.\nintros.\nsubst.\n(* fail with \"Cannot find any non-recursive equality over x\" while it could at least substitute x (or y) once *)\n\nI just pushed a fix which hopefully will fix [BZ#4214](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%234214%22) and which behaves in the contribs as expected (i.e. avoiding an extra subst or rewrite after a subst).\n\nAnother question is what to do with equations x=x? Should it be part of the specification of subst to remove them? Maybe, but I'm afraid again of the possible consequences on generated names of hypotheses.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534541","html_url":"https://github.com/coq/coq/issues/4222#issuecomment-337534541","issue_url":"https://api.github.com/repos/coq/coq/issues/4222","id":337534541,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDU0MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-07-16T08:14:16Z","updated_at":"2017-10-18T10:01:39Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nThere is an option \"Set Regular Subst Tactic\" to recover old behavior of subst. Moreover it is unset by default in 8.5. I guess I can consider this bug closed.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]