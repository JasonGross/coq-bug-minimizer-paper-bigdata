[{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153238453","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153238453","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153238453,"node_id":"IC_kwDOABUDh85EvQW1","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T17:18:31Z","updated_at":"2022-06-12T17:41:16Z","author_association":"MEMBER","body":"If I compile all of the module setup in one file and then perf just `Require Import` of that file and `Time Extraction \"A7.ml\" A7.empty.` in another file, I get [slow-extraction-a7.perf.data.zip](https://github.com/coq/coq/files/8886326/slow-extraction-a7.perf.data.zip) [flame graph in slow-extraction-a7.svg.gz](https://github.com/coq/coq/files/8886380/slow-extraction-a7.svg.gz)\r\n\r\n```\r\nSamples: 61K of event 'cpu-clock:uhpppH', Event count (approx.): 15328500000\r\n  Children      Self  Command       Shared Object                       Symbol\r\n+   98.75%     0.00%  coqc          coqc                                [.] camlFlags__with_modified_ref_inner_288\r\n+   98.65%     0.00%  coqc          coqc                                [.] camlVernacinterp__interp_typed_vernac_344\r\n+   98.65%     0.00%  coqc          coqc                                [.] camlVernacinterp__fun_1367\r\n+   98.63%     0.00%  coqc          coqc                                [.] camlVernacinterp__interp_gen_1036\r\n+   98.62%     0.00%  coqc          coqc                                [.] camlVernacinterp__fun_1471\r\n+   98.58%     0.00%  coqc          coqc                                [.] camlStm__step_8361\r\n+   98.57%     0.00%  coqc          coqc                                [.] camlStm__define_inner_9584\r\n+   98.48%     0.00%  coqc          coqc                                [.] camlStm__reach_inner_10490\r\n+   98.42%     0.00%  coqc          coqc                                [.] camlStm__observe_6390\r\n+   98.29%     0.00%  coqc          coqc                                [.] camlVernac__interp_vernac_224\r\n+   98.24%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extract_env__extract_structure_2480\r\n+   98.23%     0.00%  coqc          coqc                                [.] camlSystem__with_time_1197\r\n+   98.21%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extract_env__full_extr_3527\r\n+   98.18%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extract_env__extract_module_2484\r\n+   98.18%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extract_env__extract_msignature_spec_2317\r\n+   98.18%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extract_env__extract_structure_spec_2314\r\n+   98.17%     0.00%  coqc          coqc                                [.] camlStdlib__list__rmap_f_253\r\n+   98.17%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extract_env__fun_4728\r\n+   98.17%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__extract_constant_spec_3810\r\n+   98.12%     2.47%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__extract_type_2708\r\n+   97.90%     0.69%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__fun_4736\r\n+   97.90%     0.58%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__extract_type_app_2709\r\n+   97.76%     0.00%  coqc          coqc                                [.] camlVernac__loop_324\r\n+   97.41%     0.00%  coqc          coqc                                [.] camlVernac__load_vernac_core_253\r\n+   96.90%     0.00%  coqc          coqc                                [.] camlVernac__load_vernac_1043\r\n+   96.37%     0.00%  coqc          coqc                                [.] camlCcompile__compile_344\r\n+   96.17%     1.77%  coqc          coqc                                [.] camlStdlib__list__fold_right_278\r\n+   95.54%     0.00%  coqc          coqc                                [.] camlCcompile__compile_file_1117\r\n+   94.57%     0.00%  coqc          coqc                                [.] camlCoqc__coqc_main_140\r\n+   93.34%     0.00%  coqc          coqc                                [.] camlCoqc__coqc_run_248\r\n+   91.98%     0.00%  coqc          coqc                                [.] camlDune__exe__Coqc_bin__entry\r\n+   91.39%     0.00%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__record_constant_type_3292\r\n+   90.23%     0.00%  coqc          coqc                                [.] caml_startup__code_begin\r\n+   88.20%     0.00%  coqc          coqc                                [.] caml_start_program\r\n+   85.88%     0.00%  coqc          coqc                                [.] caml_startup\r\n+   83.41%     0.00%  coqc          coqc                                [.] main\r\n+   80.72%     0.00%  coqc          libc-2.31.so                        [.] __libc_start_main\r\n+   40.49%     0.88%  coqc          coqc                                [.] camlRetyping__sort_family_of_1961\r\n+   30.86%     0.30%  coqc          coqc                                [.] camlRetyping__type_of_global_reference_knowing_parameters_1543\r\n+   28.99%     1.65%  coqc          coqc                                [.] camlRetyping__type_of_1541\r\n+   28.18%     0.81%  coqc          coqc                                [.] camlInductive__type_of_inductive_gen_1677\r\n+   27.03%     0.87%  coqc          coqc                                [.] camlInductive__instantiate_universes_1657\r\n+   22.51%     0.96%  coqc          coqc                                [.] camlInductive__make_1626\r\n+   19.91%     0.64%  coqc          coqc                                [.] camlRetyping__fun_2482\r\n+   16.67%     1.42%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Mlutil__expand_2536\r\n+   16.05%     0.31%  coqc          coqc                                [.] camlRetyping__anomaly_on_error_483\r\n+   13.29%     0.92%  coqc          coqc                                [.] camlReductionops__red_of_state_red_3904\r\n+   13.20%     0.61%  coqc          coqc                                [.] camlEnviron__lookup_constant_key_1446\r\n+   12.25%     0.84%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__mlt_env_2714\r\n+   10.76%     0.84%  coqc          coqc                                [.] camlStdlib__map__find_opt_280\r\n+   10.19%     0.99%  coqc          coqc                                [.] camlCList__map_802\r\n+   10.01%     1.58%  coqc          coqc                                [.] camlUniv__subst_univs_universe_5335\r\n+    9.17%     1.24%  coqc          coqc                                [.] camlEvd__kind_3908\r\n+    7.77%     0.44%  coqc          coqc                                [.] camlCList__map_loop_795\r\n+    7.69%     1.77%  coqc          coqc                                [.] camlHMap__find_opt_1821\r\n+    7.37%     0.07%  coqc          coqc                                [.] camlArguments_renaming__rename_type_of_constant_1412\r\n+    7.22%     0.29%  coqc          coqc                                [.] camlTypeops__type_of_constant_in_1430\r\n+    6.66%     0.33%  coqc          coqc                                [.] camlEnviron__lookup_mind_key_1498\r\n+    6.46%     2.51%  coqc          coqc                                [.] camlUniv__fun_7183\r\n+    6.44%     2.30%  coqc          coqc                                [.] camlHMap__find_1815\r\n+    5.46%     1.81%  coqc          coqc                                [.] camlCList__compare_496\r\n+    5.46%     0.42%  coqc          coqc                                [.] camlRetyping__concl_of_arity_1040\r\n+    5.38%     5.38%  coqc          coqc                                [.] camlInt__find_opt_1428\r\n+    4.68%     1.37%  coqc          coqc                                [.] camlConstr__map_with_binders_2478\r\n+    4.53%     2.44%  coqc          coqc                                [.] camlReductionops__whrec_3562\r\n+    3.82%     0.34%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__flag_of_type_733\r\n+    3.78%     0.42%  coqc          coqc                                [.] camlEnviron__template_polymorphic_ind_2705\r\n+    3.71%     0.22%  coqc          coqc                                [.] camlUnivSubst__aux_650\r\n+    3.66%     0.41%  coqc          coqc                                [.] camlRetyping__subst_type_1023\r\n+    3.56%     0.73%  coqc          coqc                                [.] camlSorts__sort_of_univ_245\r\n+    3.56%     1.69%  coqc          coqc                                [.] camlCList__equal_505\r\n+    3.51%     0.29%  coqc          coqc                                [.] camlUnivSubst__find_716\r\n+    3.42%     3.42%  coqc          coqc                                [.] caml_string_compare\r\n+    3.37%     3.37%  coqc          coqc                                [.] camlEvd__whd_evar_3934\r\n+    2.93%     0.10%  coqc          coqc                                [.] camlReductionops__aux_3127\r\n+    2.89%     0.48%  coqc          coqc                                [.] camlStdlib__string__compare_333\r\n+    2.79%     0.55%  coqc          coqc                                [.] camlCArray__map_1659\r\n+    2.73%     2.73%  coqc          coqc                                [.] caml_apply2\r\n+    2.57%     0.29%  coqc          coqc                                [.] camlReductionops__decrec_4785\r\n+    2.49%     0.25%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__type_sign_1692\r\n+    2.49%     0.07%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__extract_ind_2711\r\n+    2.28%     0.19%  coqc          coqc                                [.] camlRetyping__sort_of_arity_with_constraints_1013\r\n+    2.27%     0.86%  coqc          coqc                                [.] camlNames__compare_2670\r\n+    2.14%     0.23%  coqc          coqc                                [.] camlInductive__lookup_mind_specif_340\r\n+    2.03%     0.14%  coqc          coqc                                [.] camlReductionops__splay_arity_4823\r\n+    1.78%     0.15%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Extraction__applistc_1355\r\n+    1.76%     0.99%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Mlutil__subst_1309\r\n+    1.72%     0.87%  coqc          coqc                                [.] camlReductionops__whrec_3828\r\n+    1.65%     1.65%  coqc          coqc                                [.] caml_page_table_lookup\r\n+    1.59%     0.00%  coqc          coqc                                [.] caml_alloc_small_dispatch\r\n+    1.59%     0.00%  coqc          coqc                                [.] caml_call_gc\r\n+    1.56%     1.56%  coqc          libc-2.31.so                        [.] __memcmp_avx2_movbe\r\n+    1.55%     1.12%  coqc          coqc                                [.] camlNames__compare_2155\r\n+    1.45%     0.24%  coqc          coqc                                [.] camlStdlib__array__of_list_192\r\n+    1.42%     0.41%  coqc          coqc                                [.] camlArguments_renaming__rename_type_1386\r\n+    1.39%     0.25%  coqc          coqc                                [.] camlStdlib__list__fold_left_272\r\n+    1.29%     1.29%  coqc          coqc                                [.] camlInt__find_1412\r\n+    1.23%     0.00%  coqc          coqc                                [.] caml_major_collection_slice\r\n+    1.23%     0.31%  coqc          extraction_plugin.cmxs              [.] camlExtraction_plugin__Table__lookup_typedef_1985\r\n+    1.18%     0.82%  coqc          coqc                                [.] camlHMap__add_1651\r\n+    1.14%     0.47%  coqc          coqc                                [.] camlReductionops__fun_6807\r\n+    1.10%     1.10%  coqc          coqc                                [.] camlCDebug__pp_597\r\nCannot load tips.txt file, please install perf!\r\n```\r\n ","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153238453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153247938","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153247938","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153247938,"node_id":"IC_kwDOABUDh85EvSrC","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T17:59:44Z","updated_at":"2022-06-12T17:59:44Z","author_association":"MEMBER","body":"@ppedrot How do you debug why `camlExtraction_plugin__Extraction__extract_type_app` is taking so much time here?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153247938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153276605","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153276605","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153276605,"node_id":"IC_kwDOABUDh85EvZq9","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T19:51:14Z","updated_at":"2022-06-12T19:52:08Z","author_association":"CONTRIBUTOR","body":"Simplified:\r\n~~~coq\r\nModule Type T.\r\nParameter t : Type.\r\nEnd T.\r\n\r\nModule F (X:T).\r\n  (* number of occurences determines the exponential: here 4 *)\r\n  Definition t : Type := X.t * X.t * X.t * X.t.\r\nEnd F.\r\n\r\nRequire Import Coq.extraction.Extraction.\r\n\r\nModule A0. Definition t := nat. End A0.\r\n\r\nModule A1 := F A0.\r\nModule A2 := F A1.\r\nModule A3 := F A2.\r\nModule A4 := F A3.\r\nModule A5 := F A4.\r\nModule A6 := F A5.\r\nModule A7 := F A6.\r\nModule A8 := F A7.\r\n\r\nTime Recursive Extraction A5.t. (* 0.03s *)\r\nTime Recursive Extraction A6.t. (* 0.09s *)\r\nTime Recursive Extraction A7.t. (* 0.38s *)\r\nTime Recursive Extraction A8.t. (* 1.55s *)\r\n~~~\r\nIt's related to this recursion https://github.com/coq/coq/blob/4287924381a7b10ad81efea98dbe58b76b5faf46/plugins/extraction/extraction.ml#L313-L315 as indeed replacing the whole parenthesized block by `mlt` goes fast.\r\nI don't know what issue the comment refers to.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153276605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153285379","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153285379","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153285379,"node_id":"IC_kwDOABUDh85Evb0D","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T20:29:30Z","updated_at":"2022-06-12T20:29:30Z","author_association":"MEMBER","body":"@SkySkimmer I don't think that's a fair comparison.  The fully reduced version of your type is of size 4^n, while the fully reduced version of my type is of size n.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153285379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153290246","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153290246","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153290246,"node_id":"IC_kwDOABUDh85EvdAG","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T20:54:12Z","updated_at":"2022-06-12T20:54:12Z","author_association":"CONTRIBUTOR","body":"Are you sure?\r\n~~~coq\r\nSet Printing All.\r\nEval lazy [OptionPositiveMap.t A2.t] in A2.t nat.\r\n(*      = prod (option (@sig (A1.t nat) (fun m : A1.t nat => not (@A1.Empty nat m))))\r\n         (PositiveMap.t (@sig (A1.t nat) (fun m : A1.t nat => not (@A1.Empty nat m))))\r\n*)\r\n~~~\r\nthere are 2 `A1.t` in there (eval on A1.t produces messy results because A0.t and OptionPositiveMap.t are the same ref so get same transparency)","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153290246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153300166","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153300166","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153300166,"node_id":"IC_kwDOABUDh85EvfbG","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T21:40:24Z","updated_at":"2022-06-12T21:40:24Z","author_association":"MEMBER","body":"Ah, I see, the product on in the Option combines with the nesting in the Prod to generate an exponentially sized type.  So it makes a bit more sense, but given that the types are still relatively small and the code generated is not insane, I think the performance should be much better.  At the very least, the results of this call should be cached so that the overhead doesn't build when I fill all the other parameters.  (In my real example, which contains approximately 6 layers of ProdMap, it takes about 90 minutes to extract the code.)","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153300166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153302789","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153302789","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153302789,"node_id":"IC_kwDOABUDh85EvgEF","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T21:58:24Z","updated_at":"2022-06-12T21:58:24Z","author_association":"MEMBER","body":"The comment originates in https://github.com/coq/coq/commit/8109673237ab65997465743632db07ecb033f068, which is not especially informative, btw","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153302789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153302902","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153302902","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153302902,"node_id":"IC_kwDOABUDh85EvgF2","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T21:59:20Z","updated_at":"2022-06-12T21:59:20Z","author_association":"MEMBER","body":"Can a flag be added to disable this optimization?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153302902/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153304462","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153304462","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153304462,"node_id":"IC_kwDOABUDh85EvgeO","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T22:09:05Z","updated_at":"2022-06-12T22:09:05Z","author_association":"CONTRIBUTOR","body":"What makes you think it's an optimization and not a bugfix?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153304462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153321544","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153321544","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153321544,"node_id":"IC_kwDOABUDh85EvkpI","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T23:26:38Z","updated_at":"2022-06-13T12:47:03Z","author_association":"MEMBER","body":"I would believe it's a bug fix, but given it's enormous performance cost, I'd like the ability to disable it and instead manually inline the relevant things.  (Alternatively, if caching the result of this function makes extraction in https://github.com/mit-plv/fiat-crypto/pull/1293 not take 90 minutes, I'd be satisfied with that)\r\n\r\nHowever, it seems like this call is being invoked for types that show up nowhere in the .ml file (because they will just be functor instantiations), so maybe the use of this procedure on applied functors should be fixed instead?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153321544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153321705","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153321705","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153321705,"node_id":"IC_kwDOABUDh85Evkrp","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2022-06-12T23:27:29Z","updated_at":"2022-06-12T23:27:29Z","author_association":"MEMBER","body":"Also, I don't think disabling this check can result in incorrect code that compiles, only in code that fails to compile","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153321705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153869133","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1153869133","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1153869133,"node_id":"IC_kwDOABUDh85ExqVN","user":{"login":"ppedrot","id":1202327,"node_id":"MDQ6VXNlcjEyMDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/1202327?v=4","gravatar_id":"","url":"https://api.github.com/users/ppedrot","html_url":"https://github.com/ppedrot","followers_url":"https://api.github.com/users/ppedrot/followers","following_url":"https://api.github.com/users/ppedrot/following{/other_user}","gists_url":"https://api.github.com/users/ppedrot/gists{/gist_id}","starred_url":"https://api.github.com/users/ppedrot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppedrot/subscriptions","organizations_url":"https://api.github.com/users/ppedrot/orgs","repos_url":"https://api.github.com/users/ppedrot/repos","events_url":"https://api.github.com/users/ppedrot/events{/privacy}","received_events_url":"https://api.github.com/users/ppedrot/received_events","type":"User","site_admin":false},"created_at":"2022-06-13T12:44:55Z","updated_at":"2022-06-13T12:44:55Z","author_association":"MEMBER","body":"Given the comments of some commits (d504428276e30d31f8c39cfa1bccc9021c154b3a) around this piece of code I can't say this looks very principled...","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1153869133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1158824274","html_url":"https://github.com/coq/coq/issues/16172#issuecomment-1158824274","issue_url":"https://api.github.com/repos/coq/coq/issues/16172","id":1158824274,"node_id":"IC_kwDOABUDh85FEkFS","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-06-17T12:30:14Z","updated_at":"2022-06-17T12:30:14Z","author_association":"CONTRIBUTOR","body":"Let's try just removing it and see what happens","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1158824274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]