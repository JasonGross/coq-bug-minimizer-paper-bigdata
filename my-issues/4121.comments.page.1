[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532744","html_url":"https://github.com/coq/coq/issues/4121#issuecomment-337532744","issue_url":"https://api.github.com/repos/coq/coq/issues/4121","id":337532744,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzMjc0NA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-03-12T19:42:32Z","updated_at":"2017-10-18T09:56:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nHere is code that works in 8.5beta1, but not current v8.5/trunk.\n\n(* -*- coq-prog-args: (\"-emacs\" \"-nois\") -*- *)\n(* File reduced by coq-bug-finder from original input, then from 830 lines to 47 lines, then from 25 lines to 11 lines *)\n(* coqc version 8.5beta1 (March 2015) compiled on Mar 11 2015 18:51:36 with OCaml 4.01.0\n   coqtop version cagnode15:/afs/csail.mit.edu/u/j/jgross/coq-8.5,v8.5 (8dbfee5c5f897af8186cb1bdfb04fd4f88eca677) *)\n\nSet Universe Polymorphism.\nClass Contr_internal (A : Type) := BuildContr { center : A }.\nArguments center A {_}.\nClass Contr (A : Type) : Type := Contr_is_trunc : Contr_internal A.\nHint Extern 0 => progress change Contr_internal with Contr in * : typeclass_instances.\nDefinition contr_paths_contr0 {A} `{Contr A} : Contr A := {| center := center A |}.\nInstance contr_paths_contr1 {A} `{Contr A} : Contr A := {| center := center A |}.\nCheck @ contr_paths_contr0@ {i}.\nCheck @ contr_paths_contr1@ {i}. (* Error: Universe instance should have length 2 *)\n(** It should have length 1, just like contr_paths_contr0 *)\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532745","html_url":"https://github.com/coq/coq/issues/4121#issuecomment-337532745","issue_url":"https://api.github.com/repos/coq/coq/issues/4121","id":337532745,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzMjc0NQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-03-12T19:47:44Z","updated_at":"2017-10-18T09:56:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nNote that if we give the typeclass instances explicitly, the [change] hint is unnecessary, and the bug goes away (regardless of whether the [Hint] is there or not); this works fine:\n\nSet Universe Polymorphism.\nClass Contr_internal (A : Type) := BuildContr { center : A }.\nClass Contr (A : Type) : Type := Contr_is_trunc : Contr_internal A.\nDefinition contr_paths_contr0 {A} `{H : Contr A} : Contr A := {| center := @ center A H |}.\nInstance contr_paths_contr1 {A} `{H : Contr A} : Contr A := {| center := @ center A H |}.\nCheck @ contr_paths_contr0@ {i}.\nCheck @ contr_paths_contr1@ {i}.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532746","html_url":"https://github.com/coq/coq/issues/4121#issuecomment-337532746","issue_url":"https://api.github.com/repos/coq/coq/issues/4121","id":337532746,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzMjc0Ng==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-03-12T19:50:06Z","updated_at":"2017-10-18T09:56:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nNote that using more standard (but circular) hints makes the bug go away too; this works:\n\nSet Universe Polymorphism.\nClass Contr_internal (A : Type) := BuildContr { center : A }.\nArguments center A {_}.\nClass > Contr (A : Type) : Type := Contr_is_trunc :> Contr_internal A.\nDefinition contr_paths_contr0 {A} `{H : Contr A} : Contr A := {| center := center A |}.\nInstance contr_paths_contr1 {A} `{H : Contr A} : Contr A := {| center := center A |}.\nCheck @ contr_paths_contr0@ {i}.\nCheck @ contr_paths_contr1@ {i}. \n\nSo maybe this is somehow related to bug [BZ#4120](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%234120%22)?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532747","html_url":"https://github.com/coq/coq/issues/4121#issuecomment-337532747","issue_url":"https://api.github.com/repos/coq/coq/issues/4121","id":337532747,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzMjc0Nw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-04-09T02:41:54Z","updated_at":"2017-10-18T09:56:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nThis, too, is caused by\n\ncommit 2d3916766d3f145643a994aa83174c98394d5baa\nAuthor: Matthieu Sozeau <matthieu.sozeau@ inria.fr>\nDate:   Tue Mar 3 21:45:42 2015 +0100\n\n    Fix bug [BZ#3590](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%233590%22), keeping evars that are not turned into named metas by\n    pattern_of_constr in an evar_map, as they can appear in the context\n    of said named metas, which is used by change. Not sure what to do in\n    the PEvar case, which never matches anyway according to Constr_matching.matches.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532751","html_url":"https://github.com/coq/coq/issues/4121#issuecomment-337532751","issue_url":"https://api.github.com/repos/coq/coq/issues/4121","id":337532751,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzMjc1MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-04-09T15:52:19Z","updated_at":"2017-10-18T09:56:29Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nNot exactly related to 4120 but slightly, [change] adds a universe level that's unused, but Instance did not perform restriction as Definition does to get rid of those spurious universes. Fixed in v8.5 branch.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337532751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]