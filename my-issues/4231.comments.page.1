[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534679","html_url":"https://github.com/coq/coq/issues/4231#issuecomment-337534679","issue_url":"https://api.github.com/repos/coq/coq/issues/4231","id":337534679,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDY3OQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-09T18:19:04Z","updated_at":"2021-07-07T16:48:36Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\r\n```coq\r\n(* File reduced by coq-bug-finder from original input, then from 981 lines to 33 lines *)\r\n(* coqc version 8.5beta2 (May 2015) compiled on May 5 2015 15:20:21 with OCaml 4.01.0\r\n   coqtop version 8.5beta2 (May 2015) *)\r\n\r\nAxiom ap : forall {A B:Type} (f:A -> B) {x y:A} (p:x = y), f x = f y.\r\n\r\nDefinition Sect {A B : Type} (s : A -> B) (r : B -> A) :=\r\n  forall x : A, r (s x) = x.\r\n\r\nClass IsEquiv {A B : Type} (f : A -> B) := BuildIsEquiv {\r\n  equiv_inv : B -> A ;\r\n  eisretr : Sect equiv_inv f;\r\n  eissect : Sect f equiv_inv;\r\n  eisadj : forall x : A, eisretr (f x) = ap f (eissect x)\r\n}.\r\n\r\nDefinition Lift (A : Type@ {i}) : Type@ {j}\r\n  := Eval hnf in let enforce_lt := Type@ {i} : Type@ {j} in A.\r\n\r\nDefinition lower {A} : Lift A -> A := fun x => x.\r\n\r\nDefinition lift2 {A B} (f : forall x : A, B x) : forall x : Lift A, Lift (B (lower x))\r\n  := f.\r\n\r\nGlobal Instance lift_isequiv {A B} (f : A -> B) {H : IsEquiv f} : @ IsEquiv _ _ (lift2 f).\r\n(* Toplevel input, characters 95-102:\r\nError:\r\nIn environment\r\nA : Type\r\nB : Type\r\nf : A -> B\r\nH : IsEquiv f\r\nThe term \"lift2 f\" has type \"Lift A -> Lift B\"\r\nwhile it is expected to have type \"Lift A -> ?T0\" (cannot instantiate\r\n\"?T0\" because \"x\" is not in its scope: available arguments are\r\n\"A\" \"B\" \"f\" \"H\"). *)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534680","html_url":"https://github.com/coq/coq/issues/4231#issuecomment-337534680","issue_url":"https://api.github.com/repos/coq/coq/issues/4231","id":337534680,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDY4MA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-05-12T08:57:16Z","updated_at":"2021-07-07T16:48:47Z","author_association":"CONTRIBUTOR","body":"Comment author: @silene\r\n\r\nJust to reduce a bit the attack surface, this is not related to records, explicit type indices, nor type classes.\r\n```coq\r\nDefinition IsEquiv {A B : Type} (f : A -> B) := B -> A.\r\nDefinition Lift (A : Type) : Type := A.\r\nDefinition lift2 {A B} (f : forall x : A, B x) : (forall y : A, Lift (B y)) := f.\r\nDefinition lift_isequiv A B (f : A -> B) : IsEquiv (lift2 f).\r\n\r\nThe term \"lift2 f\" has type \"A -> Lift B\"\r\nwhile it is expected to have type \"A -> ?B\"\r\n(cannot instantiate \"?B\" because \"y\" is not in its scope:\r\navailable arguments are \"A\" \"B\" \"f\").\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534681","html_url":"https://github.com/coq/coq/issues/4231#issuecomment-337534681","issue_url":"https://api.github.com/repos/coq/coq/issues/4231","id":337534681,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDY4MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-02-17T18:44:31Z","updated_at":"2017-10-18T10:02:03Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nWhat's the issue with this error? Although it is a bit difficult to understand when you don't have the correct mental model for evars, it does make sense to me: You're trying to depend on the argument of a non-dependent function.\n\nWhat would you like instead?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534682","html_url":"https://github.com/coq/coq/issues/4231#issuecomment-337534682","issue_url":"https://api.github.com/repos/coq/coq/issues/4231","id":337534682,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDY4Mg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-02-17T22:28:51Z","updated_at":"2017-10-18T10:02:04Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\n1. I expect unification to succeed; the function is not dependent\n\n2. It would be better if the message said what term it was trying to instantiate T0 with.\n\n3.  To make the error message more accessible to beginners, this message should be prefaced with something like \"you are trying to unify a dependent function with a non dependent function\" when that's the case.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534683","html_url":"https://github.com/coq/coq/issues/4231#issuecomment-337534683","issue_url":"https://api.github.com/repos/coq/coq/issues/4231","id":337534683,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNDY4Mw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-02-18T09:48:24Z","updated_at":"2021-07-07T16:49:03Z","author_association":"CONTRIBUTOR","body":"Comment author: @silene\r\n\r\nI agree with Jason. My reduced example is well-typed, yet Coq fails to successfully type it. I known that this is undecidable and all that. But here the situation is quite dumb. Indeed, Coq tells you that it cannot unify \"A -> Lift B\" and \"A -> ?B\", yet if you tell Coq that ?B is \"Lift B\", it miraculously succeeds. Sure, it is a limitation of the evar implementation. Still, Coq should not tell you that it cannot unify ?B and Lift B; it should tell you _why_ it cannot unify them.\r\n```coq\r\nDefinition IsEquiv {A B : Type} (f : A -> B) := B -> A.\r\nDefinition Lift (A : Type) : Type := A.\r\nDefinition lift2 {A B} (f : forall x : A, B x) : (forall y : A, Lift (B y)) := f.\r\nDefinition lift_isequiv A B (f : A -> B) : IsEquiv (B := _ _) (lift2 f).\r\n(* success!!! *)\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337534683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/875765072","html_url":"https://github.com/coq/coq/issues/4231#issuecomment-875765072","issue_url":"https://api.github.com/repos/coq/coq/issues/4231","id":875765072,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NTc2NTA3Mg==","user":{"login":"Alizter","id":8614547,"node_id":"MDQ6VXNlcjg2MTQ1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/8614547?v=4","gravatar_id":"","url":"https://api.github.com/users/Alizter","html_url":"https://github.com/Alizter","followers_url":"https://api.github.com/users/Alizter/followers","following_url":"https://api.github.com/users/Alizter/following{/other_user}","gists_url":"https://api.github.com/users/Alizter/gists{/gist_id}","starred_url":"https://api.github.com/users/Alizter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Alizter/subscriptions","organizations_url":"https://api.github.com/users/Alizter/orgs","repos_url":"https://api.github.com/users/Alizter/repos","events_url":"https://api.github.com/users/Alizter/events{/privacy}","received_events_url":"https://api.github.com/users/Alizter/received_events","type":"User","site_admin":false},"created_at":"2021-07-07T16:51:43Z","updated_at":"2021-07-07T16:51:43Z","author_association":"CONTRIBUTOR","body":"Tested in 8.15+alpha, coq seems to accept all of it.\r\n\r\nTherefore closing.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/875765072/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]