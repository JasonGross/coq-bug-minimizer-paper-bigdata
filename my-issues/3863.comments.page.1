[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528231","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528231","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528231,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODIzMQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-14T18:28:48Z","updated_at":"2017-10-18T09:43:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nCreated attachment 523\ntest case\n\nI was dubious about this error, so I went and reproduced it on travis: https://travis-ci.org/JasonGross/coqc-coqtop-univ-bug/builds/44014792.\n\nAll six of these should be identical, but they are not:\njgross@ cagnode14:/tmp/baz$ coqc -nois -indices-matter -no-native-compiler bug_extensions_univ_helper_05.v\nishprop_ooextendable\n     : forall (C : ?B -> Type) (f : ?A -> ?B),\n       IsHProp (ooExtendableAlong f C)\nwhere\n?A : [ |- Type]\n?B : [ |- Type]\njgross@ cagnode14:/tmp/baz$ coqtop -nois -indices-matter -no-native-compiler -compile bug_extensions_univ_helper_05\nishprop_ooextendable\n     : forall (C : ?B -> Type) (f : ?A -> ?B),\n       IsHProp (ooExtendableAlong f C)\nwhere\n?A : [ |- Type]\n?B : [ |- Type]\njgross@ cagnode14:/tmp/baz$ coqtop -nois -indices-matter -no-native-compiler -load-vernac-source bug_extensions_univ_helper_05.v\nWelcome to Coq cagnode15:/afs/csail.mit.edu/u/j/jgross/coq-trunk,trunk (c938cb8e85f741ce697e7486d35c27c1aa31fe7a)\nError during initialization:\nError while reading bug_extensions_univ_helper_05.v:\nFile \"/tmp/baz/bug_extensions_univ_helper_05.v\", line 218, characters 6-26:\nError: Universe instance should have length 7\njgross@ cagnode14:/tmp/baz$ ln -s bug_extensions_univ_helper_05.v tmp.v\njgross@ cagnode14:/tmp/baz$ ls -la tmp.v\nlrwxrwxrwx 1 jgross jgross 31 Dec 14 13:26 tmp.v -> bug_extensions_univ_helper_05.v\njgross@ cagnode14:/tmp/baz$ coqc -nois -indices-matter -no-native-compiler tmp.v\nFile \"./tmp.v\", line 218, characters 6-26:\nError: Universe instance should have length 7\njgross@ cagnode14:/tmp/baz$ coqtop -nois -indices-matter -no-native-compiler -compile tmp\nFile \"./tmp.v\", line 218, characters 6-26:\nError: Universe instance should have length 7\njgross@ cagnode14:/tmp/baz$ coqtop -nois -indices-matter -no-native-compiler -load-vernac-source tmp.v\nWelcome to Coq cagnode15:/afs/csail.mit.edu/u/j/jgross/coq-trunk,trunk (c938cb8e85f741ce697e7486d35c27c1aa31fe7a)\nError during initialization:\nError while reading tmp.v:\nFile \"/tmp/baz/tmp.v\", line 218, characters 6-26:\nError: Universe instance should have length 7\n\n> Attached file: [bug_extensions_univ_helper_05.v](https://coq.inria.fr/bugfiles/attachment.cgi?id=523) (application/octet-stream, 7885 bytes)\n> Description:   test case\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528232","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528232","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528232,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODIzMg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T15:51:22Z","updated_at":"2017-10-18T09:43:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nNote: declarations are made in module Top when using \"coqtop -load-vernac-source\", while they are made in a module named after the name of the file in the case of \"coqtop -compile\", what explains the difference.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528233","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528233","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528233,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODIzMw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T16:18:39Z","updated_at":"2017-10-18T09:43:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nAs said on github, it's minimization not being invariant w.r.t. the order of constraints.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528235","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528235","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528235,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODIzNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T16:35:09Z","updated_at":"2017-10-18T09:43:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nPS: If you want -load-vernac-source to use the same module name as if calling \"coqtop -compile\", use the option \"-top logical_name\", in your case \"-top bug_extensions_univ_helper_05\".\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528237","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528237","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528237,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODIzNw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T23:17:33Z","updated_at":"2017-10-18T09:43:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nHugo, thanks for the info!\n\nMatthieu, thanks for tracking this down!\n\nFor future reference, the github comment (https://github.com/HoTT/HoTT/pull/593#issuecomment-67018165) was:\n\n> Ok, now I get it. Minimization is not invariant w.r.t the ordering of\n> constraints, it folds over the set of constraints and depending on the\n> order they're given it gives different results. If the library name changes\n> then the ordering of constraints in the set differs. If only we had HITs in\n> OCaml I couldn't have made that mistake :) I hope to fix it sometime this\n> week.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528240","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528240","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528240,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODI0MA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-09-16T16:20:19Z","updated_at":"2017-10-18T09:43:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nUpon further investigation, minimization is not exactly the problem. The issue is that going through the universes and back to constraints is not \"normalizing\" as I expected, in particular one can start with constraints:\n\n i <= j, j <= k and i <= k and get (depending on the order they're processed)\n\n i <= j, j <= k or the initial set (as i <= k) is implied by the other constraints.\n\nNow thinking about how to get a kind of normal form or be insensitive to that.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528241","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528241","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528241,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODI0MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-09-16T16:20:35Z","updated_at":"2017-10-18T09:43:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nUpon further investigation, minimization is not exactly the problem. The issue is that going through the universes and back to constraints is not \"normalizing\" as I expected, in particular one can start with constraints:\n\n i <= j, j <= k and i <= k and get (depending on the order they're processed)\n\n i <= j, j <= k or the initial set (as i <= k) is implied by the other constraints.\n\nNow thinking about how to get a kind of normal form or be insensitive to that.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528242","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528242","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528242,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODI0Mg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-09-16T17:09:37Z","updated_at":"2017-10-18T09:43:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @jhjourdan\n\nI may be a bit naive, but I think there is an algorithm that is stable to the addition of redundant constraints and simple to describe:\n\nLet's take the universe graph, and add a new special arc b <= a for each constraint a <= b such that a OR b is flexible. Then, for each of these arcs that is not part of a strict cycle in this new graph, set a:=b (or b:=a). There is no problem of order, because it should be done once and for all in the whole graph.\n\nWhat do you think ?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528245","html_url":"https://github.com/coq/coq/issues/3863#issuecomment-337528245","issue_url":"https://api.github.com/repos/coq/coq/issues/3863","id":337528245,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyODI0NQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T19:42:44Z","updated_at":"2017-10-18T09:43:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @silene\n\nThanks to Matthieu's rework of universe levels, all the variations fail in the same way, so it seems fixed. Please reopen if you encounter new discrepancies.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337528245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]