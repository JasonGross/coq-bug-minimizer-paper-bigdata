[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521338","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521338","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521338,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTMzOA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-07-22T10:38:50Z","updated_at":"2017-10-18T09:23:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nCreated attachment 494\nLong example of a slow [End lemmas.]\n\nThe [End lemmas.] near the end of the attached file (currently annotated with a [Timeout]) takes 4-5 s in interactive mode (\"coqtop -indices-matter -time < psedo_rewrite_laws_01.v\") and 7-8 s in batch mode (either of \"coqtop -indices-matter -time -compile psedo_rewrite_laws_01\" and \"coqc -indices-matter -time psedo_rewrite_laws_01.v\").  This is in trunk (c4ecec191130a51975bf97d067472e0e5bd744f5).  In HoTT/coq, it took 0.3 s.\n\n> Attached file: [psedo_rewrite_laws_01.v](https://coq.inria.fr/bugfiles/attachment.cgi?id=494) (text/plain, 347867 bytes)\n> Description:   Long example of a slow [End lemmas.]\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521339","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521339","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521339,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTMzOQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-07-30T07:32:55Z","updated_at":"2017-10-18T09:23:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nFor the record, about half of the time is taken by the hashconsing of universes.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521340","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521340","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521340,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM0MA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-07-30T09:02:26Z","updated_at":"2017-10-18T09:23:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nI consistently get 3s in interactive and batch mode now. Which part of hashconsing is concerned here, Instance.hcons or Universe/Level?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521341","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521341","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521341,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM0MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-07-30T09:05:03Z","updated_at":"2017-10-18T09:23:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nActually both, as the former triggers the latter (hence this is Instance, if you will). Ultimately, term hashconsing is the one responsible. If I am not mistaken, we re-hashcons everything when leaving a section.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521343","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521343","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521343,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM0Mw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-08-15T15:05:00Z","updated_at":"2017-10-18T09:23:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nIn current trunk (8bc0159095), hashconsing is not the most costly operation anymore, but universe substitutions are. On the [End lemmas] command, coqtop passes a fourth of its time in finding universes because of substitution.\n\nAnyway, does the required time seem more acceptable now?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521346","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521346","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521346,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM0Ng==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-02-27T15:32:04Z","updated_at":"2017-10-18T09:23:43Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nThe proposed example does not compile anymore...\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521351","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521351","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521351,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-04T05:33:59Z","updated_at":"2017-10-18T09:23:43Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nCreated attachment 718\nUpdated long example that compiles extremely slowly\n\nThe fact that the example no longer compiles is a bug. (Bug [BZ#4780](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%234780%22))  I've attached a version that should compile in 8.5pl1, but we seem to have regressed in performance significantly.  Earlier end sections are already slow, and [Time Record Pseudofunctor := ...] is insanely slow (it takes minutes, at least); I see\n  Pseudofunctor is defined\n  p_object_of is defined\nand then I have to wait a number of seconds before I see\n  p_morphism_of is defined\nand then I have to wait even more time for the rest, and I haven't seen it finish yet.  What's going on?\n\n> Attached file: [foo.v](https://coq.inria.fr/bugfiles/attachment.cgi?id=718) (text/x-verilog, 348062 bytes)\n> Description:   Updated long example that compiles extremely slowly\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521353","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521353","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521353,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1Mw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-04T06:11:30Z","updated_at":"2017-10-18T09:23:43Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nThe definition of Pseudofunctor finished\n  Finished transaction in 999.206 secs (998.952u,0.184s) (successful)\nI'm pretty sure it used to be much faster...\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521354","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521354","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521354,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1NA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-04T06:28:11Z","updated_at":"2017-10-18T09:23:43Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nAnd the corresponding `End pseudofunctor.`:\n  Finished transaction in 981.981 secs (981.08u,0.488s) (successful)\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521355","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521355","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521355,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1NQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-07-20T10:37:49Z","updated_at":"2017-10-18T09:23:43Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nWill investigate after the fix to [BZ#4780](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%234780%22) is committed\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521356","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521356","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521356,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1Ng==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-07-20T17:35:06Z","updated_at":"2017-10-18T09:23:44Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nWith your last example, and on trunk, I see Time Record taking half a second (however sometimes my PG hangs for some reason). The End Lemmas is around 3secs, depending if you turn Lets into Definitions this can be made faster. There is something very fishy with the constraints though. The last definition takes hundreds of universes but only has constraints on a few of them. Pseudofunctor is the same. So it's already that definition which takes too many unnecessary universes.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521357","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521357","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521357,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1Nw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-07-20T19:06:38Z","updated_at":"2017-10-18T09:23:44Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nHmmmmm, I'll have to check what's going on; on linux, 8.5pl1 seems to be reasonably fast.\n\nIn any case, the second example no longer compiles in 8.6 / trunk; there seems to be a bug in unification.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521358","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521358","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521358,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1OA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-07-21T12:08:36Z","updated_at":"2017-10-18T09:23:44Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nOk I found the culprit: the automatic generation of rewrite lemmas, when done in sections, needlessly generalizes the rewriting lemmas over the section universes, even if they are unused in the rewriting lemma itself. To fix this properly would require a way to declare that a section constant uses no universes from the section, which would require a major redesign I think. The quick workaround (which might also greatly benefit HoTT in general) is to add the following two lemmas after the definition of paths:\n\n\nLemma paths_rew@ {i j} : forall (A : Type@ {i}) (a : A) (P : A -> Type@ {j}) \n                          (f : P a) (y : A) (p : a = y), P y.\nProof.\n  intros. rewrite <- p. exact f.\nDefined.\n\nLemma paths_rew_r@ {i j} : forall (A : Type@ {i}) (y : A) (P : A -> Type@ {j}) \n                            (f : P y) (a : A) (p : a = y), P a.\nProof.\n  intros. rewrite p. exact f.\nDefined.\n\nThat way, End Lemmas takes 0.1s and has much less universes and constraints. Another thing which appeared is that compose_composition_of is defined in a section with Variable B : PreCategory. is declared but not used, again generating a useless quantification on universes. Same goes for quantifications of Funext on definitions which don't need it (why make Funext polymorphic actually??), like left_identity_natural_transformation_1. \n\nThe whole files takes 7.5s to compile on 8.5 or 8.6 here. There might still be things that could be improved, i.e. it seems NaturalTransformation.Identity.identity takes two universes which are just upper bounds and should be algebraic and hence substituted by a max expression but I suppose they're due to the generic construction you are using and that their appearance in a constant instance which prevents that disappears after the simpl.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521359","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521359","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521359,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM1OQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-07-21T12:11:43Z","updated_at":"2017-10-18T09:23:44Z","author_association":"CONTRIBUTOR","body":"Comment author: @mattam82\n\nCreated attachment 742\nFixed script.\n\nFixes the unification issue (not sure it's a bug, it looks like an arbitrary choice was made before) and adds declarations of internal_paths_rew(_r)\n\n> Attached file: [3450.v](https://coq.inria.fr/bugfiles/attachment.cgi?id=742) (text/plain, 342004 bytes)\n> Description:   Fixed script.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521362","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521362","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521362,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM2Mg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-08-19T23:50:27Z","updated_at":"2017-10-18T09:23:44Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nI have identified the source source of the huge slowdown of the record definition. It is due to the use of a naive data structure in the VM compilation phase. Indeed, we pass most of our time browsing a list in O(n) while this can be done in O(log n) thanks to a binary map. With a simple patch, the definition time of the record cuts down from more than 10mn (I got bored of waiting) to 39s!\n\nThis touches the kernel, so I want people to double check I didn't do anything wrong. Here is the PR.\n\nhttps://github.com/coq/coq/pull/261\n\nWhat do you think about it?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521364","html_url":"https://github.com/coq/coq/issues/3450#issuecomment-337521364","issue_url":"https://api.github.com/repos/coq/coq/issues/3450","id":337521364,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUyMTM2NA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-08-22T14:22:09Z","updated_at":"2017-10-18T09:23:45Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nFixed by 5ede69.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337521364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]