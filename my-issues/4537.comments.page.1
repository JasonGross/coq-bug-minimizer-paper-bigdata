[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539530","html_url":"https://github.com/coq/coq/issues/4537#issuecomment-337539530","issue_url":"https://api.github.com/repos/coq/coq/issues/4537","id":337539530,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzOTUzMA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-27T07:38:51Z","updated_at":"2017-10-18T10:16:33Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nCreated attachment 660\nbuggy file\n\nThe attached file builds with Coq 8.5, and, if you replace the [simple refine] with [refine], with Coq 8.5beta2.  The timing differences:\n\n    Time simple refine <some stuff>\n    (* 8.5beta2 (replace [simple refine] with [refine]: 3.186 secs (3.183u,0.s) *)\n    (* 8.5: 4.585 secs (4.584u,0.004s) *)\n    Time all: try exact _. (* 8.5beta2: 0.46 secs (0.456u,0.004s); 8.5: 1.812 secs (1.812u,0.s) *)\n    Undo.\n    Time 5: try exact _. (* 8.5beta2: 0.978 secs (0.976u,0.s); 8.5: 5.676 secs (5.668u,0.s) *)\n\n> Attached file: [bug_csu_slow_tc_04.v](https://coq.inria.fr/bugfiles/attachment.cgi?id=660) (application/octet-stream, 45446 bytes)\n> Description:   buggy file\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539533","html_url":"https://github.com/coq/coq/issues/4537#issuecomment-337539533","issue_url":"https://api.github.com/repos/coq/coq/issues/4537","id":337539533,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzOTUzMw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-27T08:29:13Z","updated_at":"2017-10-18T10:16:33Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nAll right, I think I'm the responsible here. This is probably because of commit a895b2c0ca that introduced a performance enhancement of auto hints *in the non-polymorphic case*. The polymorphic case has a nice comment\n\n(** FIXME: We're being inefficient here because we substitute the whole\n          evar map instead of just its metas, which are the only ones\n          mentioning the old universes. *)\n\nwhich is exactly the hotspot I'm seeing right there. I'll write a quick fix.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539534","html_url":"https://github.com/coq/coq/issues/4537#issuecomment-337539534","issue_url":"https://api.github.com/repos/coq/coq/issues/4537","id":337539534,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzOTUzNA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-27T08:53:38Z","updated_at":"2017-10-18T10:16:33Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nFixed by 22a2cc1.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539535","html_url":"https://github.com/coq/coq/issues/4537#issuecomment-337539535","issue_url":"https://api.github.com/repos/coq/coq/issues/4537","id":337539535,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzOTUzNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-27T09:04:34Z","updated_at":"2017-10-18T10:16:34Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nNote that there is still a hotspot that looks suspicious to me. Indeed, the code for Evarsolve.noccur_evar whose goal is essentially to ensure that an evar does not appear in a term repeatedly calls the following snippet of code\n\n    let c = \n      try Retyping.expand_projection env evd p c []\n      with Retyping.RetypeError _ -> \n\t(* Can happen when called from w_unify which doesn't assign evars/metas \n\t   eagerly enough *) c\n    in occur_rec acc c\n\nwhich is responsible for ~50% of the time passed in one of your tactics for no good reason.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539536","html_url":"https://github.com/coq/coq/issues/4537#issuecomment-337539536","issue_url":"https://api.github.com/repos/coq/coq/issues/4537","id":337539536,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzOTUzNg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-29T21:34:25Z","updated_at":"2017-10-18T10:16:34Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nThanks!  This fixes almost all of the speed issues in HoTT that have arisen in the update from 8.5beta2 to 8.5.  However, there's a case of a (non-setoid) keyed unification [rewrite] that used to take 0.02 s, which now takes over 100s, if it terminates at all...\n\nThe big changes from 8.5beta2 to 8.5-22a2cc are:\nAfter    | File Name                           | Before   || Change   \n----------------------------------------------------------------------\n>2m08.39s| Algebra/ooGroup                     | 0m06.72s || +2m01.66s\n0m05.84s | categories/Adjoint/Pointwise        | 0m24.01s || -0m18.17s\n0m15.51s | hit/V                               | 0m11.04s || +0m04.47s\n0m13.56s | categories/Category/Sigma/Univalent | 0m11.02s || +0m02.54s\n0m07.67s | contrib/Freudenthal                 | 0m06.62s || +0m01.04s\n0m04.29s | Modalities/Lex                      | 0m05.38s || -0m01.08s\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337539536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]