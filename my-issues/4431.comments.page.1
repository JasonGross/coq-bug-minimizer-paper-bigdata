[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537803","html_url":"https://github.com/coq/coq/issues/4431#issuecomment-337537803","issue_url":"https://api.github.com/repos/coq/coq/issues/4431","id":337537803,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNzgwMw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-11-17T21:53:36Z","updated_at":"2017-10-18T10:11:23Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\n(Coq 8.5beta3)  This error only occurs in interactive mode.  In non-interactive mode, I just get \"Anomaly: Uncaught exception Not_found. Please report.\"\n\nThe backtrace from -debug is:\nframe @  file \"toplevel/coqtop.ml\", line 615, characters 6-22\nframe @  file \"toplevel/vernac.ml\", line 346, characters 2-13\nframe @  file \"toplevel/vernac.ml\", line 315, characters 14-48\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 137, characters 19-41\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 11, characters 15-18\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 253, characters 6-43\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1952, characters 2-35\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 137, characters 19-41\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 11, characters 15-18\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 253, characters 6-43\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1952, characters 2-35\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 11, characters 15-18\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 253, characters 6-43\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1952, characters 2-35\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 253, characters 6-43\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1952, characters 2-35\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1952, characters 2-35\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1952, characters 2-35\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 1942, characters 4-48\nframe @  file \"stm/stm.ml\", line 1909, characters 4-91\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 733, characters 6-10\nframe @  file \"stm/stm.ml\", line 1799, characters 29-47\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"stm/stm.ml\", line 97, characters 15-71\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernacentries.ml\", line 2159, characters 10-346\nframe @  file \"lib/flags.ml\", line 137, characters 19-41\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 11, characters 15-18\nframe @  file \"toplevel/vernacentries.ml\", line 848, characters 15-500\nframe @  file \"proofs/proof_global.ml\", line 152, characters 24-36\nframe @  file \"toplevel/vernacentries.ml\", line 853, characters 6-75\nraise @  unknown\nframe @  file \"proofs/pfedit.ml\", line 107, characters 28-67\nframe @  file \"proofs/proof.ml\", line 339, characters 4-30\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernacentries.ml\", line 2159, characters 10-346\nframe @  file \"lib/flags.ml\", line 137, characters 19-41\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 11, characters 15-18\nframe @  file \"toplevel/vernacentries.ml\", line 848, characters 15-500\nframe @  file \"proofs/proof_global.ml\", line 152, characters 24-36\nframe @  file \"toplevel/vernacentries.ml\", line 853, characters 6-75\nraise @  unknown\nframe @  file \"proofs/pfedit.ml\", line 107, characters 28-67\nframe @  file \"proofs/proof.ml\", line 339, characters 4-30\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"lib/flags.ml\", line 11, characters 15-18\nframe @  file \"toplevel/vernacentries.ml\", line 848, characters 15-500\nframe @  file \"proofs/proof_global.ml\", line 152, characters 24-36\nframe @  file \"toplevel/vernacentries.ml\", line 853, characters 6-75\nraise @  unknown\nframe @  file \"proofs/pfedit.ml\", line 107, characters 28-67\nframe @  file \"proofs/proof.ml\", line 339, characters 4-30\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"proofs/proofview.ml\", line 1139, characters 25-65\nframe @  file \"pretyping/evd.ml\", line 1661, characters 15-20\nframe @  file \"proofs/proofview.ml\", line 1130, characters 10-44\nframe @  file \"tactics/tacinterp.ml\", line 2157, characters 32-69\nframe @  file \"pretyping/patternops.ml\", line 192, characters 10-33\nframe @  file \"pretyping/patternops.ml\", line 158, characters 49-84\nframe @  file \"array.ml\", line 79, characters 21-40\nframe @  file \"pretyping/patternops.ml\", line 158, characters 49-84\nframe @  file \"array.ml\", line 77, characters 21-40\nframe @  file \"pretyping/evd.ml\", line 815, characters 24-36\nraise @  file \"lib/int.ml\", line 37, characters 20-29\n\n(the associated tactic is [change c with c'])\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537805","html_url":"https://github.com/coq/coq/issues/4431#issuecomment-337537805","issue_url":"https://api.github.com/repos/coq/coq/issues/4431","id":337537805,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNzgwNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2015-11-19T18:06:24Z","updated_at":"2017-10-18T10:11:23Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nTest-case in 8.5beta3:\n\n$ cat foo.v\nRequire Import Coq.Arith.Arith Coq.Init.Wf.\nAxiom proof_admitted : False.\nGoal exists x y z : nat, Fix\n                           Wf_nat.lt_wf\n                           (fun _ => nat -> nat)\n                           (fun x' f => match x' as x'0\n                                              return match x'0 with\n                                                       | 0 => True\n                                                       | S x'' => x'' < x'\n                                                     end\n                                                     -> nat -> nat\n                                        with\n                                          | 0 => fun _ _ => 0\n                                          | S x'' => f x''\n                                        end\n                                          (match x' with\n                                             | 0 => I\n                                             | S x'' => (Nat.lt_succ_diag_r _)\n                                           end))\n                           z\n                           y\n                         = 0.\nProof.\n  do 3 (eexists; [ shelve.. | ]).\n  match goal with |- ?G => let G' := (eval lazy in G) in change G with G' end.\n$ coqtop -debug -emacs < foo.v\n...\n<prompt>Unnamed_thm < 6 |branch| 0 < </prompt>Toplevel input, characters 2-78:\n>   match goal with |- ?G => let G' := (eval lazy in G) in change G with G' end.\n>   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAnomaly: error with no safe_id attached:\nUncaught exception Not_found.\nframe @  file \"stm/stm.ml\", line 2452, characters 8-30\nframe @  file \"stm/stm.ml\", line 1953, characters 33-58\nraise @  unknown\nframe @  file \"stm/stm.ml\", line 123, characters 6-33\nframe @  file \"printing/printer.ml\", line 587, characters 4-43\nframe @  file \"printing/printer.ml\", line 478, characters 16-59\nframe @  file \"pretyping/evarutil.ml\", line 598, characters 15-63\nframe @  file \"pretyping/evarutil.ml\", line 570, characters 12-26\nraise @  file \"lib/int.ml\", line 37, characters 20-29. Please report.\nframe @  file \"toplevel/coqloop.ml\", line 317, characters 4-39\nraise @  file \"lib/exninfo.ml\", line 63, characters 8-15\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/errors.ml\", line 23, characters 18-39\nframe @  file \"toplevel/vernac.ml\", line 233, characters 6-16\nraise @  file \"lib/errors.ml\", line 23, characters 18-39\n\n<prompt>Unnamed_thm < 7 |branch| 0 < </prompt>\n\n\nIs it the case that any anomaly will not have a safe_id attached, and so will result in this occurring in interactive tty mode?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537806","html_url":"https://github.com/coq/coq/issues/4431#issuecomment-337537806","issue_url":"https://api.github.com/repos/coq/coq/issues/4431","id":337537806,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNzgwNg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-11T17:57:50Z","updated_at":"2017-10-18T10:11:23Z","author_association":"CONTRIBUTOR","body":"Comment author: @gares\n\nI can't reproduce the bug on 8.5rc1, looks the root cause was fixed\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537809","html_url":"https://github.com/coq/coq/issues/4431#issuecomment-337537809","issue_url":"https://api.github.com/repos/coq/coq/issues/4431","id":337537809,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNzgwOQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-01-11T19:25:32Z","updated_at":"2017-10-18T10:11:23Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nIs it that the code I suggested no longer gives an anomaly in 8.5rc1, or that you have an anomaly in 8.5rc1, but this behavior no longer occurs?\n\nThere are two issues this bug report is about, nominally:\n1. The error message about safe_ids has an extra period\n2. Getting an anomaly gives rise to a safe_id error message on backtracking.\n\n(If the code I gave doesn't give an anomaly any more, that just means that you need a new test-case for this bug.)\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537811","html_url":"https://github.com/coq/coq/issues/4431#issuecomment-337537811","issue_url":"https://api.github.com/repos/coq/coq/issues/4431","id":337537811,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUzNzgxMQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-09-06T15:03:57Z","updated_at":"2017-10-18T10:11:23Z","author_association":"CONTRIBUTOR","body":"Comment author: @gares\n\nI think the double period bug was closed by Guillaume a while ago.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337537811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]