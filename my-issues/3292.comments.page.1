[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518905","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518905","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518905,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkwNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-24T04:16:07Z","updated_at":"2017-10-18T09:16:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\njgross@ cagnode17:~/HoTT/coqdoctest$ cat Overture.v\njgross@ cagnode17:~/HoTT/coqdoctest$ cat HomFunctor2.v\n(** * Hom *)\nRequire Import Overture.\n\n(** ** Definition of [hom : Cᵒᵖ × C → Set] as a functor *)\njgross@ cagnode17:~/HoTT/coqdoctest$ rm *.css *.v.d *.vo *.html *.glob *.d; coq_makefile Overture.v HomFunctor2.v -R . HoTT | make -f -; coqdoc -utf8 -html -R . HoTT HomFunctor2.v; grep '<a name=\"lab2\">' HoTT.HomFunctor2.html\nrm: cannot remove `HomFunctor2.v.d': No such file or directory\nrm: cannot remove `Overture.v.d': No such file or directory\n\"coqdep\" -c -R . HoTT \"HomFunctor2.v\" > \"HomFunctor2.v.d\" || ( RV=$?; rm -f \"HomFunctor2.v.d\"; exit ${RV} )\n\"coqdep\" -c -R . HoTT \"Overture.v\" > \"Overture.v.d\" || ( RV=$?; rm -f \"Overture.v.d\"; exit ${RV} )\n\"coqc\"  -q  -R . HoTT   Overture\n\"coqc\"  -q  -R . HoTT   HomFunctor2\n<a name=\"lab2\"></a><h2 class=\"section\">Definition of <span class=\"inlinecode\"><span class=\"id\" type=\"var\">hom</span></span> <span class=\"inlinecode\">:</span> <span class=\"inlinecode\"><span class=\"id\" type=\"var\">C</span>ᵒᵖ</span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">×</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">C</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">�</span>�</span> <span class=\"inlinecode\"><span class=\"id\" type=\"keyword\">Set</span></span> as a functor</h2>\njgross@ cagnode17:~/HoTT/coqdoctest$\n\nThe \"less\" utility reveals that it is turning the unicode right arrow character into \"<span class=\"inlinecode\"><span class=\"id\" type=\"library\"><E2><86></span><92></span>\".  Which characters this happens to changes when I change unrelated things, such as whether the bullet at the top is called \"Hom\" or is empty, and whether or not I remove the word \"Definition\".  It also disappears if I remove the [Require Overture.], even though [Overture.v] is empty.\n\nThis occurs with both 8.4pl3, and trunk.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518906","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518906","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518906,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkwNg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-26T12:31:22Z","updated_at":"2017-10-18T09:16:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nHi Jason, I tried in 8.4pl3 and trunk and it works for me. Can you check again? Hugo\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518909","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518909","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518909,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkwOQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-26T13:53:47Z","updated_at":"2017-10-18T09:16:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nThe original example is at http://hott.github.io/HoTT/coqdoc-html/HoTT.categories.HomFunctor.html (using HoTT/coq); the log is at https://travis-ci.org/HoTT/HoTT/jobs/23686613, though it is not very helpful, other than maybe indicating the version of linux.  Let me see if I can make a script that reproduces it on Windows and linux.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518910","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518910","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518910,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxMA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-26T14:34:51Z","updated_at":"2017-10-18T09:16:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nHere is a script that generates the problem on Linux and Windows:\n\n#!/bin/bash\n\nset -x\n\nif [ -z \"$COQC\" ]; then\n    COQC=\"${COQBIN}coqc\"\nfi\nif [ -z \"$COQTOP\" ]; then\n    COQTOP=\"${COQBIN}coqtop\"\nfi\nif [ -z \"$COQ_MAKEFILE\" ]; then\n    COQ_MAKEFILE=\"${COQBIN}coq_makefile\"\nfi\nif [ -z \"$COQDOC\" ]; then\n    COQDOC=\"${COQBIN}coqdoc\"\nfi\necho \"COQBIN=$COQBIN\"\necho \"COQTOP=$COQTOP\"\necho \"COQC=$COQC\"\necho \"COQ_MAKEFILE=$COQ_MAKEFILE\"\necho \"COQDOC=$COQDOC\"\n\n\"$COQC\" --version\necho | \"$COQTOP\"\n\nrm -f *.css *.v.d *.vo *.html *.glob *.d Overture.v HomFunctor2.v\ntouch Overture.v\nLANG=en_US.UTF-8\necho \"Ensure that this comes out as unicode, C^op \\times C \\to:\"\necho -e \"c\\xE1\\xB5\\x92\\xE1\\xB5\\x96 \\xC3\\x97 C \\xE2\\x86\\x92\"\ncat > HomFunctor2.v <<EOF\n(** * Hom *)\nRequire Import Overture.\nEOF\necho -e \"(** ** Definition of [hom : C\\xE1\\xB5\\x92\\xE1\\xB5\\x96 \\xC3\\x97 C \\xE2\\x86\\x92 Set] as a functor *)\" >> HomFunctor2.v\necho >> HomFunctor2.v\n\ncat Overture.v\ncat HomFunctor2.v\n\n\"$COQ_MAKEFILE\" Overture.v HomFunctor2.v -R . HoTT | make -f -\n\"$COQDOC\" -utf8 -html -R . HoTT HomFunctor2.v\n\ngrep '<a name=\"lab2\">' HoTT.HomFunctor2.html\ngrep --color='auto' -P -n \"[\\x80-\\xFF]\" HoTT.HomFunctor2.html\n\n------------------------------------------------------------------\nOn linux, the output is:\n+ '[' -z '' ']'\n+ COQC=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqc\n+ '[' -z '' ']'\n+ COQTOP=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqtop\n+ '[' -z '' ']'\n+ COQ_MAKEFILE=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coq_makefile\n+ '[' -z '' ']'\n+ COQDOC=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqdoc\n+ echo COQBIN=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/\nCOQBIN=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/\n+ echo COQTOP=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqtop\nCOQTOP=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqtop\n+ echo COQC=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqc\nCOQC=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqc\n+ echo COQ_MAKEFILE=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coq_makefile\nCOQ_MAKEFILE=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coq_makefile\n+ echo COQDOC=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqdoc\nCOQDOC=/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqdoc\n+ /afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqc --version\nThe Coq Proof Assistant, version 8.4pl3 (February 2014)\ncompiled on Feb 25 2014 11:42:23 with OCaml 4.01.0\n+ echo\n+ /afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqtop\nWelcome to Coq 8.4pl3 (February 2014)\n\nCoq < Coq <\n+ rm -f coqdoc.css HomFunctor2.v.d Overture.v.d HomFunctor2.vo Overture.vo HoTT.HomFunctor2.html index.html HomFunctor2.glob Overture.\nglob HomFunctor2.v.d Overture.v.d Overture.v HomFunctor2.v\n+ touch Overture.v\n+ LANG=en_US.UTF-8\n+ echo 'Ensure that this comes out as unicode, C^op \\times C \\to:'\nEnsure that this comes out as unicode, C^op \\times C \\to:\n+ echo -e 'c\\xE1\\xB5\\x92\\xE1\\xB5\\x96 \\xC3\\x97 C \\xE2\\x86\\x92'\n+ echo\n+ cat Overture.v\n+ cat HomFunctor2.v\n(** * Hom *)\nRequire Import Overture.\n(** ** Definition of [hom : Cᵒᵖ × C → Set] as a functor *)\n\n+ /afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coq_makefile Overture.v HomFunctor2.v -R . HoTT\n+ make -f -\n/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqdep -c -slash -R . HoTT \"HomFunctor2.v\" > \"HomFunctor2.v.d\" || ( RV=$?; rm -f \"HomFunctor2.v.d\"; exit ${RV} )\n/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqdep -c -slash -R . HoTT \"Overture.v\" > \"Overture.v.d\" || ( RV=$?; rm -f \"Overture.v.d\"; exit ${RV} )\n/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqc  -q  -R . HoTT   Overture\n/afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqc  -q  -R . HoTT   HomFunctor2\n+ /afs/csail.mit.edu/u/j/jgross/.local64/coq/coq-8.4pl3/bin/coqdoc -utf8 -html -R . HoTT HomFunctor2.v\n+ grep '<a name=\"lab2\">' HoTT.HomFunctor2.html\n<a name=\"lab2\"></a><h2 class=\"section\">Definition of <span class=\"inlinecode\"><span class=\"id\" type=\"var\">hom</span></span> <span class=\"inlinecode\">:</span> <span class=\"inlinecode\"><span class=\"id\" type=\"var\">C</span>ᵒᵖ</span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">×</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">C</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">�</span>�</span> <span class=\"inlinecode\"><span class=\"id\" type=\"keyword\">Set</span></span> as a functor</h2>\n+ grep --color=auto -P -n '[\\x80-\\xFF]' HoTT.HomFunctor2.html\n33:<a name=\"lab2\"></a><h2 class=\"section\">Definition of <span class=\"inlinecode\"><span class=\"id\" type=\"var\">hom</span></span> <span class=\"inlinecode\">:</span> <span class=\"inlinecode\"><span class=\"id\" type=\"var\">C</span>������</span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">��</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">C</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">��</span>�</span> <span class=\"inlinecode\"><span class=\"id\" type=\"keyword\">Set</span></span> as a functor</h2>\n\n-------------------------------------------------------------------------\nOn windows, the output is:\n\n+ '[' -z '' ']'\n+ COQC=coqc\n+ '[' -z '' ']'\n+ COQTOP=coqtop\n+ '[' -z '' ']'\n+ COQ_MAKEFILE=coq_makefile\n+ '[' -z '' ']'\n+ COQDOC=coqdoc\n+ echo COQBIN=\nCOQBIN=\n+ echo COQTOP=coqtop\nCOQTOP=coqtop\n+ echo COQC=coqc\nCOQC=coqc\n+ echo COQ_MAKEFILE=coq_makefile\nCOQ_MAKEFILE=coq_makefile\n+ echo COQDOC=coqdoc\nCOQDOC=coqdoc\n+ coqc --version\nThe Coq Proof Assistant, version 8.4pl3 (December 2013)\ncompiled on Dec 17 2013 16:15:28 with OCaml 3.11.2\n+ echo\n+ coqtop\nWelcome to Coq 8.4pl3 (December 2013)\n\nCoq < Coq <\n+ rm -f '*.css' ClosestPoints.v.d CommonDefinitions.v.d Tactics.v.d Tree.v.d VectorQuickSelect.v.d CommonDefinitions.vo Tactics.vo Tree.vo VectorQuickSelect.vo '*.html' CommonDefinitions.glob Tactics.glob Tree.glob VectorQuickSelect.glob ClosestPoints.v.d CommonDefinitions.v.d Tactics.v.d Tree.v.d VectorQuickSelect.v.d Overture.v HomFunctor2.v\n+ touch Overture.v\n+ LANG=en_US.UTF-8\n+ echo 'Ensure that this comes out as unicode, C^op \\times C \\to:'\nEnsure that this comes out as unicode, C^op \\times C \\to:\n+ echo -e 'c\\xE1\\xB5\\x92\\xE1\\xB5\\x96 \\xC3\\x97 C \\xE2\\x86\\x92'\ncᵒᵖ × C →\n+ cat\n+ echo -e '(** ** Definition of [hom : C\\xE1\\xB5\\x92\\xE1\\xB5\\x96 \\xC3\\x97 C \\xE2\\x86\\x92 Set] as a functor *)'\n+ echo\n+ cat Overture.v\n+ cat HomFunctor2.v\n(** * Hom *)\nRequire Import Overture.\n(** ** Definition of [hom : Cᵒᵖ × C → Set] as a functor *)\n\n+ coq_makefile Overture.v HomFunctor2.v -R . HoTT\n+ make -f -\ncoqdep -c -slash -R . HoTT \"HomFunctor2.v\" > \"HomFunctor2.v.d\" || ( RV=$?; rm -f \"HomFunctor2.v.d\"; exit ${RV} )\ncoqdep -c -slash -R . HoTT \"Overture.v\" > \"Overture.v.d\" || ( RV=$?; rm -f \"Overture.v.d\"; exit ${RV} )\ncoqc  -q  -R . HoTT   Overture\ncoqc  -q  -R . HoTT   HomFunctor2\n+ coqdoc -utf8 -html -R . HoTT HomFunctor2.v\n+ grep '<a name=\"lab2\">' HoTT.HomFunctor2.html\n<a name=\"lab2\"></a><h2 class=\"section\">Definition of <span class=\"inlinecode\"><span class=\"id\" type=\"var\">hom</span></span> <span class=\"inlinecode\">:</span> <span class=\"inlinecode\"><span class=\"id\" type=\"var\">C</span>ᵒᵖ</span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">×</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">C</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">▒</span>▒</span> <span class=\"inlinecode\"><span class=\"id\" type=\"keyword\">Set</span></span> as a functor</h2>\n+ grep --color=auto -P -n '[\\x80-\\xFF]' HoTT.HomFunctor2.html\n33:<a name=\"lab2\"></a><h2 class=\"section\">Definition of <span class=\"inlinecode\"><span class=\"id\" type=\"var\">hom</span></span> <span class=\"inlinecode\">:</span> <span class=\"inlinecode\"><span class=\"id\" type=\"var\">C</span>ᵒᵖ</span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">×</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">C</span></span> <span class=\"inlinecode\"><span class=\"id\" type=\"library\">▒</span>▒</span> <span class=\"inlinecode\"><span class=\"id\" type=\"keyword\">Set</span></span> as a functor</h2>\n\n\n-------------------------------------------------------------------------\n\nThe issue seems to be that it is splitting → (\\xE2\\x86\\x92) into two spans, giving \"<span class=\"inlinecode\"><span class=\"id\" type=\"library\">\\342\\206</span>\\222</span>\"; combining them into a single span makes it render correctly.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518912","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518912","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518912,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxMg==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-27T11:42:56Z","updated_at":"2017-10-18T09:16:27Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nStill no problem with your test on my 8.4pl3 compiled with ocaml 3.11.2 on a linux platform.\n\nYour symptom is very strange. How robust is the failure wrt to small modifications, e.g. characters with utf8 representation close to →, or whether → is in a comment or not?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518914","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518914","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518914,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxNA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-27T19:09:39Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nI am using Camlp5 version 6.11, ocaml 4.01.0, Linux cagnode17 2.6.32-5-xen-amd64 [BZ#1](https://github.com/coq/coq/issues?q=is%3Aissue%20%22Original%20bug%20ID%3A%20BZ%231%22) SMP Sun Sep 23 13:49:30 UTC 2012 x86_64 GNU/Linux.  Also the Coq 8.4pl3 Windows binary on the Coq website.  Both of my machines are little-endian, in case that matters (determined by http://stackoverflow.com/a/1001373/377022).\n\nIt also occurs with Coq 8.3pl4 as packaged for precise.\n\nThe failure is exceedingly fragile; removing the [Require] (of the empty file) makes it go away.  Removing the header comment (the comment in the file which this isn't a part of) changes which part gets split (it makes the ^op go wrong instead).  Removing the word \"Definition\" from the comment makes it go away.  Adding \"n\" to \"Definition\" makes the split be one character inside, two outside, rather than all outside.  Adding yet another \"n\" removes the <span class=\"id\" type=\"library\"> all-together, making the three characters be outside.  So my limited experimentation suggests it is robust to changes in which bytes are used in each unicode location and which characters are used in each non-unicode location, but very, very fragile to where the bytes are.  Perhaps there is a problem with endianness?  Or with coqdoc or camlp5 or ocaml assuming that all characters in UTF-8 are either one or two bytes?  Or something in the pipeline not knowing enough to deal with the variable-length encoding that is UTF-8?  But I'm just guessing here.\n\nHere is a way for you to play with it yourself: If you fork https://github.com/JasonGross/coqdoc-bug, make a free Travis-CI account at https://travis-ci.org/profile, and enable Travis for your fork of the repository, then any time you push a change, Travis will re-run coqdoc for you and create a log at https://travis-ci.org/<your github name>/coqdoc-bug within a few minutes.  The relevant files to edit are HomFunctor2.v and Overture.v at the top-level.  The .travis.yml file tells Travis what to do, so you can add lines to that to get more info about their system or configuration, or to build a different version of Coq or OCaml, etc.  (Be warned, there's a 50 minute limit to a build, which isn't enough time to build all of Coq from scratch.  It's enough to build the coqlight target, though.)\n\nAnyway, here is a complete build log: https://travis-ci.org/JasonGross/coqdoc-bug/builds/23881027; the relevant bit of info, at the bottom, is that there are three groups of unicode characters, and one of them (in this case, the third) is split between a span.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518915","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518915","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518915,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-27T20:54:08Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nThe <span class=\"id\" type=\"library\"> </span> which is breaking the arrow is suspicious in your log (I don't get it when I try your script).\n\nThis suggests that the .glob is broken or that locations found by coqdoc are not interpreted the same as locations produced by coqc.\n\nCan you show your HomFunctor2.glob?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518917","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518917","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518917,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxNw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-27T21:08:33Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\njgross@ cagnode17:~/tmp$ coqc -v\nThe Coq Proof Assistant, version 8.4pl3 (February 2014)\ncompiled on Feb 25 2014 11:42:23 with OCaml 4.01.0\njgross@ cagnode17:~/tmp$ echo | coqtop\nWelcome to Coq 8.4pl3 (February 2014)\n\nCoq < Coq <\njgross@ cagnode17:~/tmp$ cat HomFunctor2.glob\nDIGEST 0d41004b83ce8e26eea80598d5bbc860\nFHoTT.HomFunctor2\nR28:35 HoTT.Overture <> <> lib\njgross@ cagnode17:~/tmp$ cat Overture.glob\nDIGEST d41d8cd98f00b204e9800998ecf8427e\nFHoTT.Overture\njgross@ cagnode17:~/tmp$ cat HomFunctor2.v\n(** * Hom *)\nRequire Import Overture.\n(** ** Definition of [hom : Cᵒᵖ × C → Set] as a functor *)\n\njgross@ cagnode17:~/tmp$ cat Overture.v\njgross@ cagnode17:~/tmp$\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518918","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518918","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518918,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxOA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-27T21:10:05Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nAnd here is a log that includes the glob file cats, once it finishes: https://travis-ci.org/JasonGross/coqdoc-bug/builds/23888537\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518919","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518919","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518919,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkxOQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-04-28T12:29:28Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nThanks Jason, I could fix the problem (interpretation of coq expressions within comments was not done with the correct absolute location, leading to accidental collisions with the locations in the glob file). I could not see the problem myself at first because I had removed the \"-R . HoTT\" option at coqc in my experiments, which was simpler because in a local archive.\n\nFix is in trunk (8d3c142ec750612b7d02777ff2d6fd5286fb683d), v8.4 (997060ba5e7099c8362bc429d259c407ce503f34).\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518920","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518920","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518920,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkyMA==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-06-10T23:09:42Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: David M. Cooke &lt;<david.m.cooke@gmail.com>&gt;\n\nCreated attachment 482\nFix off-by-one error when generating .glob\n\nHere's a patch that fixes the splitting of multibyte characters in notations.\nI think this bug is the same one that I found :P\n\nThe problem isn't in coqdoc, it's in the generated .glob file.\nWith a notation like\n  Notation \"%\" := bar\nwe would find lines like\n  R473:472 x <> ::'%' not\nin the .glob file -- which says the notation starts at position 473,\nand ends just before position 472. So the end of the notation off by one;\nfor a multibyte notation, then, the last byte is not included, giving invalid characters when coqdoc puts markup between the first bytes and the last one.\n\n> Attached file: [off-by-one-in-glob.diff](https://coq.inria.fr/bugfiles/attachment.cgi?id=482) (text/plain, 1546 bytes)\n> Description:   Fix off-by-one error when generating .glob\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518921","html_url":"https://github.com/coq/coq/issues/3292#issuecomment-337518921","issue_url":"https://api.github.com/repos/coq/coq/issues/3292","id":337518921,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzUxODkyMQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2014-06-17T14:09:07Z","updated_at":"2017-10-18T09:16:28Z","author_association":"CONTRIBUTOR","body":"Comment author: @herbelin\n\nHi David, there is indeed a problem introduced in the trunk. Some code factorization made in dumpglob.ml revealed that locs_of_notation was indeed not computing locations in standard format (i.e. with end position being the position of the next byte). Thanks for your patch that I used as support for the fix (committed 4e0e3022ca9e).\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337518921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]