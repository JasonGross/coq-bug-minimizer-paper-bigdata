[{"url":"https://api.github.com/repos/coq/coq/issues/comments/351898340","html_url":"https://github.com/coq/coq/issues/6432#issuecomment-351898340","issue_url":"https://api.github.com/repos/coq/coq/issues/6432","id":351898340,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTg5ODM0MA==","user":{"login":"ejgallego","id":7192257,"node_id":"MDQ6VXNlcjcxOTIyNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7192257?v=4","gravatar_id":"","url":"https://api.github.com/users/ejgallego","html_url":"https://github.com/ejgallego","followers_url":"https://api.github.com/users/ejgallego/followers","following_url":"https://api.github.com/users/ejgallego/following{/other_user}","gists_url":"https://api.github.com/users/ejgallego/gists{/gist_id}","starred_url":"https://api.github.com/users/ejgallego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejgallego/subscriptions","organizations_url":"https://api.github.com/users/ejgallego/orgs","repos_url":"https://api.github.com/users/ejgallego/repos","events_url":"https://api.github.com/users/ejgallego/events{/privacy}","received_events_url":"https://api.github.com/users/ejgallego/received_events","type":"User","site_admin":false},"created_at":"2017-12-15T02:46:57Z","updated_at":"2017-12-15T02:52:20Z","author_association":"MEMBER","body":"**edit** well, your theory about processes seems right. Not gonna be easy to fix.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/351898340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/351911134","html_url":"https://github.com/coq/coq/issues/6432#issuecomment-351911134","issue_url":"https://api.github.com/repos/coq/coq/issues/6432","id":351911134,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTkxMTEzNA==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2017-12-15T04:33:28Z","updated_at":"2017-12-15T04:33:28Z","author_association":"MEMBER","body":"Regarding your initial comment \"Umm, what is the problem here? Couldn't be the case that par: is actually slower?\": yes, that's fine (also note that I'm comparing `1:tac` against `par:tac`, so it's expected to be at least a bit slower in real time); the issue is that it's twice as fast in user time when it does 3x as much stuff, which makes no sense.  (I didn't get an email about the first edit, so maybe you already realized this.  But if it confused you, I figure it's worth explaining for others.)","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/351911134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/554129973","html_url":"https://github.com/coq/coq/issues/6432#issuecomment-554129973","issue_url":"https://api.github.com/repos/coq/coq/issues/6432","id":554129973,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDEyOTk3Mw==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2019-11-14T23:18:33Z","updated_at":"2019-11-14T23:18:33Z","author_association":"MEMBER","body":"I think is actually quite easy to fix (though I haven't tested).  If I understand correctly, then we can take\r\nhttps://github.com/coq/coq/blob/6a6a2575c10d05cd0151a83c133825d43bd3cb28/lib/system.ml#L279-L281\r\nand make the change\r\n```diff\r\nlet get_time () =\r\n  let t = Unix.times ()  in\r\n-  (Unix.gettimeofday(), t.Unix.tms_utime, t.Unix.tms_stime)\r\n+  (Unix.gettimeofday(), t.Unix.tms_utime + t.Unix.tms_cutime, t.Unix.tms_stime + t.Unix.tms_cstime)\r\n```\r\nto include the time spent in child processes.\r\n\r\nBy the way, here is a more clear test-case:\r\n```coq\r\nFixpoint walk (n : nat) :=\r\n  match n with\r\n  | O => tt\r\n  | S n => fst (walk n, walk n)\r\n  end.\r\n\r\nGoal True /\\ True.\r\n  split.\r\n  Time par: let v := eval native_compute in (walk 30) in exact I.\r\n  (* Finished transaction in 7.657 secs (0.027u,0.02s) (successful) *)\r\n```\r\n\r\nNote that `Time` also does not currently report time spent in the OCaml compiler under user time, and, if I understand correctly, this change would also fix this problem.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/554129973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]