[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337553883","html_url":"https://github.com/coq/coq/issues/5528#issuecomment-337553883","issue_url":"https://api.github.com/repos/coq/coq/issues/5528","id":337553883,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU1Mzg4Mw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2017-05-16T05:12:33Z","updated_at":"2017-10-18T11:02:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nI can get [admit] to produce:\nLtac call to \"admit\" failed.\nIllegal application:\nThe term \"@ fst\" of type \"forall (A B : Type) (_ : prod A B), A\"\ncannot be applied to the terms\n \"interp_base_type TZ\" : \"Type\"\n \"interp_base_type TZ\" : \"Type\"\n \"tt\" : \"unit\"\nThe 3rd term has type \"unit\" which should be coercible to\n \"prod (interp_base_type TZ) (interp_base_type TZ)\".\nand I can get [simpl] to produce\nAnomaly: Uncaught exception Failure(\"List.skipn\"). Please report at \nhttp://coq.inria.fr/bugs/.\n\nExample file coming up momentarily\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337553883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337553886","html_url":"https://github.com/coq/coq/issues/5528#issuecomment-337553886","issue_url":"https://api.github.com/repos/coq/coq/issues/5528","id":337553886,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU1Mzg4Ng==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2017-05-16T05:13:27Z","updated_at":"2017-10-18T11:02:42Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nCreated attachment 844\nexample file\n\n> Attached file: [bug_bad_refine_simpl_anom_01.v](https://coq.inria.fr/bugfiles/attachment.cgi?id=844) (text/plain, 16119 bytes)\n> Description:   example file\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337553886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337553887","html_url":"https://github.com/coq/coq/issues/5528#issuecomment-337553887","issue_url":"https://api.github.com/repos/coq/coq/issues/5528","id":337553887,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU1Mzg4Nw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2017-05-16T05:41:18Z","updated_at":"2021-03-31T23:38:56Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\r\n\r\nHere's a smaller example:\r\n```coq\r\n(* -*- mode: coq; coq-prog-args: (\"-emacs\" \"-R\" \".\" \"Top\" \"-top\" \r\n\"bug_bad_refine_simpl_anom_01\") -*- *)\r\n(* File reduced by coq-bug-finder from original input, then from 557 lines to \r\n63 lines, then from 225 lines to 136 lines, then from 247 lines to 162 lines, \r\nthen from 325 lines to 230 lines, then from 390 lines to 264 lines, then from \r\n378 lines to 304 lines, then from 537 lines to 318 lines, then from 425 lines \r\nto 364 lines, then from 549 lines to 380 lines, then from 469 lines to 396 \r\nlines, then from 533 lines to 415 lines, then from 464 lines to 429 lines, then \r\nfrom 443 lines to 430 lines, then from 405 lines to 380 lines, then from 374 \r\nlines to 301 lines, then from 307 lines to 301 lines, then from 251 lines to \r\n151 lines, then from 157 lines to 151 lines, then from 114 lines to 86 lines, \r\nthen from 93 lines to 87 lines, then from 78 lines to 46 lines, then from 52 \r\nlines to 46 lines *)\r\n(* coqc version 8.6 (May 2017) compiled on May 11 2017 12:23:39 with OCaml \r\n4.02.3\r\n   coqtop version jgross-Leopard-WS:/home/jgross/Downloads/coq/coq-v8.6,(HEAD \r\ndetached from 7e992fa) (3b6d89acf4f233d0ed33f89c4e60bcd68e0e2820) *)\r\nModule Import LocalFalse.\r\n  Inductive False := .\r\nEnd LocalFalse.\r\nAxiom proof_admitted : False.\r\nTactic Notation \"admit\" := abstract case proof_admitted.\r\n\r\nInductive base_type := TZ | TWord (logsz : nat).\r\nInductive flat_type := Tbase (T : base_type) | Prod (A B : flat_type).\r\nSection language.\r\n  Context (interp_base_type : base_type -> Type).\r\n  Fixpoint interp_flat_type (t : flat_type) :=\r\n    match t with\r\n    | Tbase t => interp_base_type t\r\n    | Prod x y => prod (interp_flat_type x) (interp_flat_type y)\r\n    end.\r\nEnd language.\r\nContext (Name : Type).\r\nInductive exprf : flat_type -> Type :=\r\n| LetIn : forall {tx}, interp_flat_type (fun _ => Name) tx -> exprf tx -> \r\nforall {tC}, exprf tC -> exprf tC.\r\nGlobal Arguments LetIn _ _ _ {_} _.\r\nLemma interpf_do_rewrite {t} (e : exprf t) : e = e.\r\nProof.\r\n  refine match e return e = e with\r\n         | LetIn (Prod _ _) (a2, c1) _ _ => _\r\n         | _ => _\r\n         end%core;\r\n    admit.\r\n(* In nested Ltac calls to \"admit\" and \"case proof_admitted\", last call failed.\r\nError: Abstracting over the term \"proof_admitted\" leads to a term\r\nfun _ : False => LetIn (Tbase b) i0 e0 e1 = LetIn (Tbase b) i0 e0 e1\r\nwhich is ill-typed.\r\nReason is: Illegal application: \r\nThe term \"LetIn\" of type\r\n \"forall tx : flat_type,\r\n  interp_flat_type (fun _ : base_type => Name) tx ->\r\n  exprf tx -> forall tC : flat_type, exprf tC -> exprf tC\"\r\ncannot be applied to the terms\r\n \"Tbase b\" : \"flat_type\"\r\n \"i0\" : \"interp_flat_type (fun _ : base_type => Name) (Tbase b)\"\r\n \"e0\" : \"exprf f\"\r\n \"f0\" : \"flat_type\"\r\n \"e1\" : \"exprf f0\"\r\nThe 3rd term has type \"exprf f\" which should be coercible to \"exprf (Tbase b)\".\r\n *)\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337553887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]