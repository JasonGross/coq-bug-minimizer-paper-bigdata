[{"url":"https://api.github.com/repos/coq/coq/issues/comments/833016500","html_url":"https://github.com/coq/coq/issues/14207#issuecomment-833016500","issue_url":"https://api.github.com/repos/coq/coq/issues/14207","id":833016500,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzAxNjUwMA==","user":{"login":"herbelin","id":460771,"node_id":"MDQ6VXNlcjQ2MDc3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/460771?v=4","gravatar_id":"","url":"https://api.github.com/users/herbelin","html_url":"https://github.com/herbelin","followers_url":"https://api.github.com/users/herbelin/followers","following_url":"https://api.github.com/users/herbelin/following{/other_user}","gists_url":"https://api.github.com/users/herbelin/gists{/gist_id}","starred_url":"https://api.github.com/users/herbelin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/herbelin/subscriptions","organizations_url":"https://api.github.com/users/herbelin/orgs","repos_url":"https://api.github.com/users/herbelin/repos","events_url":"https://api.github.com/users/herbelin/events{/privacy}","received_events_url":"https://api.github.com/users/herbelin/received_events","type":"User","site_admin":false},"created_at":"2021-05-05T21:23:02Z","updated_at":"2021-05-05T21:23:02Z","author_association":"MEMBER","body":"Yes, this is due to several possible `return` types being tried when compiling. Thanks for telling. Fixed in #14261.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/833016500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/833081798","html_url":"https://github.com/coq/coq/issues/14207#issuecomment-833081798","issue_url":"https://api.github.com/repos/coq/coq/issues/14207","id":833081798,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzA4MTc5OA==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2021-05-05T22:12:34Z","updated_at":"2021-05-05T22:12:34Z","author_association":"MEMBER","body":"Thanks!  Though I don't think that PR fully fixes this issue; the variable `s` does not in fact catch multiple cases","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/833081798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/833372548","html_url":"https://github.com/coq/coq/issues/14207#issuecomment-833372548","issue_url":"https://api.github.com/repos/coq/coq/issues/14207","id":833372548,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzM3MjU0OA==","user":{"login":"herbelin","id":460771,"node_id":"MDQ6VXNlcjQ2MDc3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/460771?v=4","gravatar_id":"","url":"https://api.github.com/users/herbelin","html_url":"https://github.com/herbelin","followers_url":"https://api.github.com/users/herbelin/followers","following_url":"https://api.github.com/users/herbelin/following{/other_user}","gists_url":"https://api.github.com/users/herbelin/gists{/gist_id}","starred_url":"https://api.github.com/users/herbelin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/herbelin/subscriptions","organizations_url":"https://api.github.com/users/herbelin/orgs","repos_url":"https://api.github.com/users/herbelin/repos","events_url":"https://api.github.com/users/herbelin/events{/privacy}","received_events_url":"https://api.github.com/users/herbelin/received_events","type":"User","site_admin":false},"created_at":"2021-05-06T09:19:02Z","updated_at":"2021-05-06T09:19:02Z","author_association":"MEMBER","body":"Ah I see, the PR only fixes the repetition.\r\n\r\nAbout a more precise detection, this is more complicated, as the dependency is in an existential variable...","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/833372548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/833567615","html_url":"https://github.com/coq/coq/issues/14207#issuecomment-833567615","issue_url":"https://api.github.com/repos/coq/coq/issues/14207","id":833567615,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzU2NzYxNQ==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2021-05-06T14:27:15Z","updated_at":"2021-05-06T14:27:15Z","author_association":"MEMBER","body":"> About a more precise detection, this is more complicated, as the dependency is in an existential variable...\r\n\r\nIt's not the dependency I'm complaining about (I think the computation there is correct), but the claim that it matches multiple cases.\r\n\r\nWhen I `Set Printing All. Print default.`, the code I see is\r\n```coq\r\ndefault =\r\nfix default (t : B.type base_type) : @interp base_type base_interp t :=\r\n  match t as t0 return (@interp base_type base_interp t0) with\r\n  | base x => @admit (@interp base_type base_interp (@base base_type x))\r\n  | arrow s d =>\r\n      fun\r\n        _ : (fix interp (base_type : Type) (base_interp : forall _ : base_type, Type) (t0 : B.type base_type) {struct t0} : Type :=\r\n               match t0 return Type with\r\n               | base t1 => base_interp t1\r\n               | arrow s0 d0 => forall _ : interp base_type base_interp s0, interp base_type base_interp d0\r\n               end) base_type base_interp s => default d\r\n  end\r\n     : forall t : B.type base_type, @interp base_type base_interp t\r\n\r\nArguments default {t}\r\n```\r\nI thought that maybe it's complaining about `s` being matched on, but in fact getting rid of the bare `fix` with\r\n```coq\r\n  Fixpoint default {t} : interp base_interp t\r\n    := match t with\r\n       | base x => admit\r\n       | arrow s d => fun _ : interp _ _ => @default d\r\n       end.\r\n  Set Printing All.\r\n  Print default.\r\n```\r\ngives\r\n```coq\r\ndefault =\r\nfix default (t : B.type base_type) : @interp base_type base_interp t :=\r\n  match t as t0 return (@interp base_type base_interp t0) with\r\n  | base x => @admit (@interp base_type base_interp (@base base_type x))\r\n  | arrow s d => fun _ : @interp base_type base_interp s => default d\r\n  end\r\n     : forall t : B.type base_type, @interp base_type base_interp t\r\n\r\nArguments default {t}\r\n```\r\nIf I annotate the `return` type myself with `interp _ t` then the warning goes away, without changing the final code.  While the \"is the variable used\" can depend on which things are evars and which are not, I expect the detection of multiple cases vs single case to only depend on the spine(?) of the `match`, or at the very least to only depend on the final code and not on which things are evars and which are not.  Am I mistaken?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/833567615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/833797927","html_url":"https://github.com/coq/coq/issues/14207#issuecomment-833797927","issue_url":"https://api.github.com/repos/coq/coq/issues/14207","id":833797927,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzc5NzkyNw==","user":{"login":"herbelin","id":460771,"node_id":"MDQ6VXNlcjQ2MDc3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/460771?v=4","gravatar_id":"","url":"https://api.github.com/users/herbelin","html_url":"https://github.com/herbelin","followers_url":"https://api.github.com/users/herbelin/followers","following_url":"https://api.github.com/users/herbelin/following{/other_user}","gists_url":"https://api.github.com/users/herbelin/gists{/gist_id}","starred_url":"https://api.github.com/users/herbelin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/herbelin/subscriptions","organizations_url":"https://api.github.com/users/herbelin/orgs","repos_url":"https://api.github.com/users/herbelin/repos","events_url":"https://api.github.com/users/herbelin/events{/privacy}","received_events_url":"https://api.github.com/users/herbelin/received_events","type":"User","site_admin":false},"created_at":"2021-05-06T19:23:35Z","updated_at":"2021-05-06T19:23:35Z","author_association":"MEMBER","body":"Sorry for being slow in understanding. The wrong reporting is also due to side effects (there is a backtracking inside the algorithm which is counting `s` twice).\r\n\r\nI updated #14261 so that it does not use a side effect.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/833797927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/833880444","html_url":"https://github.com/coq/coq/issues/14207#issuecomment-833880444","issue_url":"https://api.github.com/repos/coq/coq/issues/14207","id":833880444,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzg4MDQ0NA==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2021-05-06T21:29:04Z","updated_at":"2021-05-06T21:29:04Z","author_association":"MEMBER","body":"Awesome, thanks!","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/833880444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]