[{"url":"https://api.github.com/repos/coq/coq/issues/comments/405343246","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-405343246","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":405343246,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTM0MzI0Ng==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2018-07-16T18:49:35Z","updated_at":"2018-07-16T18:49:35Z","author_association":"MEMBER","body":"git bisect says\r\n> 2c7fb44684b26d9c9aea0794b9f0d52088337477 is the first bad commit\r\n> commit 2c7fb44684b26d9c9aea0794b9f0d52088337477\r\n> Author: Hugo Herbelin <Hugo.Herbelin@inria.fr>\r\n> Date:   Sat Mar 17 15:23:55 2018 +0100\r\n>\r\n>    Fixes #7011 (Fix/CoFix were not considered in tactic unification).\r\n> \r\n>     :040000 040000 6d71983a951aad030eeb03643de2306dc9b053c5 72cfbeaa123f8ac5ce3eaa2054c305ac21c1984b M      pretyping\r\n>     :040000 040000 8cc5c05f6b609200c859409f84e81f7de4a91cd4 f5fa5d9f179b2a6adbf58fd8816a67e941561c5e M      test-suite\r\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/405343246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/405343286","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-405343286","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":405343286,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTM0MzI4Ng==","user":{"login":"JasonGross","id":396076,"node_id":"MDQ6VXNlcjM5NjA3Ng==","avatar_url":"https://avatars.githubusercontent.com/u/396076?v=4","gravatar_id":"","url":"https://api.github.com/users/JasonGross","html_url":"https://github.com/JasonGross","followers_url":"https://api.github.com/users/JasonGross/followers","following_url":"https://api.github.com/users/JasonGross/following{/other_user}","gists_url":"https://api.github.com/users/JasonGross/gists{/gist_id}","starred_url":"https://api.github.com/users/JasonGross/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JasonGross/subscriptions","organizations_url":"https://api.github.com/users/JasonGross/orgs","repos_url":"https://api.github.com/users/JasonGross/repos","events_url":"https://api.github.com/users/JasonGross/events{/privacy}","received_events_url":"https://api.github.com/users/JasonGross/received_events","type":"User","site_admin":false},"created_at":"2018-07-16T18:49:45Z","updated_at":"2018-07-16T18:49:45Z","author_association":"MEMBER","body":"cc @herbelin ","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/405343286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/432436865","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-432436865","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":432436865,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjQzNjg2NQ==","user":{"login":"silene","id":1674458,"node_id":"MDQ6VXNlcjE2NzQ0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1674458?v=4","gravatar_id":"","url":"https://api.github.com/users/silene","html_url":"https://github.com/silene","followers_url":"https://api.github.com/users/silene/followers","following_url":"https://api.github.com/users/silene/following{/other_user}","gists_url":"https://api.github.com/users/silene/gists{/gist_id}","starred_url":"https://api.github.com/users/silene/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/silene/subscriptions","organizations_url":"https://api.github.com/users/silene/orgs","repos_url":"https://api.github.com/users/silene/repos","events_url":"https://api.github.com/users/silene/events{/privacy}","received_events_url":"https://api.github.com/users/silene/received_events","type":"User","site_admin":false},"created_at":"2018-10-23T21:58:56Z","updated_at":"2018-10-23T21:58:56Z","author_association":"CONTRIBUTOR","body":"This seems bad. The behavior of `setoid_rewrite` should not depend on whether `flat_map` is defined recursively or not.\r\n\r\n@herbelin Is there something we can do for 8.9? Should I revert the patch on the branch?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/432436865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/432584998","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-432584998","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":432584998,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjU4NDk5OA==","user":{"login":"herbelin","id":460771,"node_id":"MDQ6VXNlcjQ2MDc3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/460771?v=4","gravatar_id":"","url":"https://api.github.com/users/herbelin","html_url":"https://github.com/herbelin","followers_url":"https://api.github.com/users/herbelin/followers","following_url":"https://api.github.com/users/herbelin/following{/other_user}","gists_url":"https://api.github.com/users/herbelin/gists{/gist_id}","starred_url":"https://api.github.com/users/herbelin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/herbelin/subscriptions","organizations_url":"https://api.github.com/users/herbelin/orgs","repos_url":"https://api.github.com/users/herbelin/repos","events_url":"https://api.github.com/users/herbelin/events{/privacy}","received_events_url":"https://api.github.com/users/herbelin/received_events","type":"User","site_admin":false},"created_at":"2018-10-24T09:31:54Z","updated_at":"2018-10-24T09:31:54Z","author_association":"MEMBER","body":"> @herbelin Is there something we can do for 8.9? Should I revert the patch on the branch?\r\n\r\nHaving `fix` and `cofix` in `unification.ml` like we have all other constructions seems natural but at the same time `unification.ml` is probably going to be progressively deprecated. In any case, no time to investigate why this breaks `setoid_rewrite`, so reverting is ok if you prefer (and thus renouncing also to #7011).","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/432584998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/433121278","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-433121278","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":433121278,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMzEyMTI3OA==","user":{"login":"silene","id":1674458,"node_id":"MDQ6VXNlcjE2NzQ0NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1674458?v=4","gravatar_id":"","url":"https://api.github.com/users/silene","html_url":"https://github.com/silene","followers_url":"https://api.github.com/users/silene/followers","following_url":"https://api.github.com/users/silene/following{/other_user}","gists_url":"https://api.github.com/users/silene/gists{/gist_id}","starred_url":"https://api.github.com/users/silene/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/silene/subscriptions","organizations_url":"https://api.github.com/users/silene/orgs","repos_url":"https://api.github.com/users/silene/repos","events_url":"https://api.github.com/users/silene/events{/privacy}","received_events_url":"https://api.github.com/users/silene/received_events","type":"User","site_admin":false},"created_at":"2018-10-25T16:37:17Z","updated_at":"2018-10-25T16:37:41Z","author_association":"CONTRIBUTOR","body":"I am a bit torn on this one. The fact that #7013 caused no issue in the tracked external developments seems to mean that it is not as bad as it seems. So, I might keep the commit around, just so that #7011 stays closed.\r\n\r\nNaive suggestion from someone who does not understand the code: What would happen if we were to replace `reduce curenvnb pb opt substn cM cN` by `unify_not_same_head curenvnb pb opt substn cM cN`? Would we get the best of both worlds? (Disclaimer: I am well aware that the suffix `not_same_head` make it look like a very dumb proposal, in the long run.)","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/433121278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/433127779","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-433127779","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":433127779,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMzEyNzc3OQ==","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2018-10-25T16:57:10Z","updated_at":"2018-10-25T16:57:10Z","author_association":"CONTRIBUTOR","body":">Failed to progress.\r\n\r\nDoes that mean the issue is not that it fails to find a subterm but rather that it recognizes that flat_map_singleton is a reflexive identity?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/433127779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1027905255","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-1027905255","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":1027905255,"node_id":"IC_kwDOABUDh849RJbn","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-02-02T12:44:26Z","updated_at":"2022-02-02T12:44:26Z","author_association":"CONTRIBUTOR","body":"With `F := (fun t => flat_map (fun x => x::nil) t)`, it's discovering that `map F ls` is convertible to `flat_map (fun x => cons (F x) nil) ls` and then rewriting that to get back to the start.\r\nOther than putting `Hint Constants Opaque : rewrite` I don't see what can be done about this.\r\nLet's see what the compat impact would be https://github.com/coq/coq/pull/15588","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1027905255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029086514","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-1029086514","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":1029086514,"node_id":"IC_kwDOABUDh849Vp0y","user":{"login":"maximedenes","id":647105,"node_id":"MDQ6VXNlcjY0NzEwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/647105?v=4","gravatar_id":"","url":"https://api.github.com/users/maximedenes","html_url":"https://github.com/maximedenes","followers_url":"https://api.github.com/users/maximedenes/followers","following_url":"https://api.github.com/users/maximedenes/following{/other_user}","gists_url":"https://api.github.com/users/maximedenes/gists{/gist_id}","starred_url":"https://api.github.com/users/maximedenes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maximedenes/subscriptions","organizations_url":"https://api.github.com/users/maximedenes/orgs","repos_url":"https://api.github.com/users/maximedenes/repos","events_url":"https://api.github.com/users/maximedenes/events{/privacy}","received_events_url":"https://api.github.com/users/maximedenes/received_events","type":"User","site_admin":false},"created_at":"2022-02-03T15:09:13Z","updated_at":"2022-02-03T15:09:13Z","author_association":"MEMBER","body":"@gares Do you have an idea of what the \"ssreflect rewrite\" way would be, to find a trade-off here?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029086514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029799120","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-1029799120","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":1029799120,"node_id":"IC_kwDOABUDh849YXzQ","user":{"login":"gares","id":1013846,"node_id":"MDQ6VXNlcjEwMTM4NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1013846?v=4","gravatar_id":"","url":"https://api.github.com/users/gares","html_url":"https://github.com/gares","followers_url":"https://api.github.com/users/gares/followers","following_url":"https://api.github.com/users/gares/following{/other_user}","gists_url":"https://api.github.com/users/gares/gists{/gist_id}","starred_url":"https://api.github.com/users/gares/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gares/subscriptions","organizations_url":"https://api.github.com/users/gares/orgs","repos_url":"https://api.github.com/users/gares/repos","events_url":"https://api.github.com/users/gares/events{/privacy}","received_events_url":"https://api.github.com/users/gares/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T09:29:01Z","updated_at":"2022-02-04T09:29:01Z","author_association":"MEMBER","body":"It does not rewrite under binders, so it would be something like `under map_eq do rewrite flat_map_singleton`. That should work (also we don't call unification, rather evarconv).\r\n\r\nI'm no so sure this helps.","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029799120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029856457","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-1029856457","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":1029856457,"node_id":"IC_kwDOABUDh849YlzJ","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T10:46:20Z","updated_at":"2022-02-04T10:46:20Z","author_association":"CONTRIBUTOR","body":"We may also consider why it works when we do \r\n~~~coq\r\nLemma foo (ls : list (list nat)) (t:list nat) : map id ls = ls /\\ flat_map (fun x => x::nil) t = t.\r\n  setoid_rewrite flat_map_singleton.\r\n~~~\r\nin other words why in `choice` https://github.com/coq/coq/blob/b67243eb4ba711e7a7790416fb08fda99c5c0b80/plugins/ltac/rewrite.ml#L1341-L1347 `Identity` is considered a success?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029856457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029858143","html_url":"https://github.com/coq/coq/issues/8080#issuecomment-1029858143","issue_url":"https://api.github.com/repos/coq/coq/issues/8080","id":1029858143,"node_id":"IC_kwDOABUDh849YmNf","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2022-02-04T10:48:49Z","updated_at":"2022-02-04T10:48:49Z","author_association":"CONTRIBUTOR","body":"Or alternatively should `rewrite_with` https://github.com/coq/coq/blob/b67243eb4ba711e7a7790416fb08fda99c5c0b80/plugins/ltac/rewrite.ml#L1453 use `progress app` instead of `app`?","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/1029858143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]