[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543387","html_url":"https://github.com/coq/coq/issues/4809#issuecomment-337543387","issue_url":"https://api.github.com/repos/coq/coq/issues/4809","id":337543387,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU0MzM4Nw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-11T18:35:27Z","updated_at":"2017-10-18T10:28:53Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nThis code works fine in 8.4, but breaks in 8.5.  This makes porting fiat-crypto to 8.5 basically impossible.\n\n(* -*- mode: coq; coq-prog-args: (\"-emacs\" \"-R\" \"src\" \"Crypto\" \"-R\" \"Bedrock\" \"Bedrock\" \"-R\" \"coqprime-8.5/Coqprime\" \"Coqprime\" \"-top\" \"bug_broken_field_01\" \"-R\" \".\" \"Top\") -*- *)\n(* File reduced by coq-bug-finder from original input, then from 322 lines to 37 lines, then from 51 lines to 37 lines, then from 51 lines to 36 lines, then from 50 lines to 36 lines, then from 120 lines to 89 lines, then from 103 lines to 89 lines, then from 158 lines to 89 lines, then from 221 lines to 130 lines, then from 198 lines to 130 lines, then from 396 lines to 321 lines, then from 424 lines to 321 lines, then from 698 lines to 321 lines, then from 484 lines to 321 lines, then from 728 lines to 321 lines, then from 499 lines to 321 lines, then from 575 lines to 321 lines, then from 639 lines to 321 lines, then from 632 lines to 321 lines, then from 648 lines to 322 lines, then from 1000 lines to 321 lines, then from 575 lines to 321 lines, then from 464 lines to 321 lines, then from 687 lines to 322 lines, then from 516 lines to 321 lines, then from 680 lines to 322 lines, then from 902 lines to 322 lines, then from 666 lines to 322 lines, then from 476 lines to 321 lines, then from 814 lines to 321 lines, then from 466 lines to 321 lines, then from 1121 lines to 321 lines, then from 600 lines to 321 lines, then from 468 lines to 321 lines, then from 619 lines to 321 lines, then from 811 lines to 351 lines, then from 418 lines to 351 lines, then from 995 lines to 377 lines, then from 411 lines to 198 lines, then from 966 lines to 275 lines, then from 379 lines to 336 lines, then from 590 lines to 397 lines, then from 411 lines to 396 lines, then from 411 lines to 296 lines, then from 310 lines to 296 lines, then from 344 lines to 174 lines, then from 188 lines to 174 lines, then from 167 lines to 122 lines, then from 136 lines to 122 lines *)\n(* coqc version 8.5pl1 (April 2016) compiled on Apr 18 2016 14:48:5 with OCaml 4.02.3\n   coqtop version 8.5pl1 (April 2016) *)\nAxiom proof_admitted : False.\nTactic Notation \"admit\" := abstract case proof_admitted.\nRequire Coq.nsatz.Nsatz.\nImport Coq.ZArith.BinInt.\nImport Coq.ZArith.Znumtheory.\n\nDefinition F (modulus : BinInt.Z) : Set.\nexact { z : BinInt.Z | z = z mod modulus }.\nDefined.\n\nSection FieldOperations.\n  Context {m : BinInt.Z}.\n  Definition pow : F m -> BinNums.N -> F m.\nadmit.\nDefined.\nEnd FieldOperations.\nExport Coq.setoid_ring.Field_tac.\nExport Coq.ZArith.ZArith.\n\nClass TwistedEdwardsParams := {\n  q : BinInt.Z;\n  a : F q;\n  d : F q\n}.\nDefinition OpaqueF : Z -> Set.\nexact F.\nDefined.\nAxiom Opaqueadd : forall {p}, OpaqueF p -> OpaqueF p -> OpaqueF p.\nAxiom Opaquemul : forall {p}, OpaqueF p -> OpaqueF p -> OpaqueF p.\nAxiom Opaquesub : forall {p}, OpaqueF p -> OpaqueF p -> OpaqueF p.\nAxiom Opaquediv : forall {p}, OpaqueF p -> OpaqueF p -> OpaqueF p.\nAxiom Opaqueopp : forall {p}, OpaqueF p -> OpaqueF p.\nAxiom Opaqueinv : forall {p}, OpaqueF p -> OpaqueF p.\nAxiom OpaqueZToField : forall {p}, BinInt.Z -> OpaqueF p.\n\nAxiom OpaqueFieldTheory : forall p, @ field_theory (OpaqueF p) (OpaqueZToField 0%Z) (OpaqueZToField 1%Z) Opaqueadd Opaquemul Opaquesub Opaqueopp Opaquediv Opaqueinv eq.\n\nLtac FIELD_SIMPL_idtac FLD lH rl :=\n  let Simpl := idtac in\n  let lemma := get_SimplifyEqLemma FLD in\n  get_FldPre FLD ();\n  Field_Scheme Simpl Ring_tac.ring_subst_niter lemma FLD lH;\n  get_FldPost FLD ().\nLtac field_simplify_eq_idtac := let G := Get_goal in field_lookup (PackField FIELD_SIMPL_idtac) [] G.\n\nLtac notConstant t := constr:NotConstant.\n    Context {prm:TwistedEdwardsParams}.\n\n    Add Field Ffield_notConstant : (OpaqueFieldTheory q)\n      (constants [notConstant]).\n\nGoal    forall (xA yA : OpaqueF (@ q prm))\n     (_ : @ eq (OpaqueF (@ q prm))\n            (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) (@ pow (@ q prm) xA (Npos (xO xH)))) (@ pow (@ q prm) yA (Npos (xO xH))))\n            (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n               (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) (@ pow (@ q prm) xA (Npos (xO xH))))\n                  (@ pow (@ q prm) yA (Npos (xO xH)))))) (xB yB : OpaqueF (@ q prm))\n     (_ : @ eq (OpaqueF (@ q prm))\n            (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) (@ pow (@ q prm) xB (Npos (xO xH)))) (@ pow (@ q prm) yB (Npos (xO xH))))\n            (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n               (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) (@ pow (@ q prm) xB (Npos (xO xH))))\n                  (@ pow (@ q prm) yB (Npos (xO xH)))))) (xC yC : OpaqueF (@ q prm))\n     (_ : @ eq (OpaqueF (@ q prm))\n            (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) (@ pow (@ q prm) xC (Npos (xO xH)))) (@ pow (@ q prm) yC (Npos (xO xH))))\n            (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n               (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) (@ pow (@ q prm) xC (Npos (xO xH))))\n                  (@ pow (@ q prm) yC (Npos (xO xH)))))),\n   @ eq (OpaqueF (@ q prm))\n     (@ Opaquediv (@ q prm)\n        (@ Opaqueadd (@ q prm)\n           (@ Opaquemul (@ q prm) xA\n              (@ Opaquediv (@ q prm)\n                 (@ Opaquesub (@ q prm) (@ Opaquemul (@ q prm) yB yC) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) xB) xC))\n                 (@ Opaquesub (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                    (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xB) xC) yB) yC))))\n           (@ Opaquemul (@ q prm) yA\n              (@ Opaquediv (@ q prm) (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) xB yC) (@ Opaquemul (@ q prm) yB xC))\n                 (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                    (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xB) xC) yB) yC)))))\n        (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n           (@ Opaquemul (@ q prm)\n              (@ Opaquemul (@ q prm)\n                 (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xA)\n                    (@ Opaquediv (@ q prm) (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) xB yC) (@ Opaquemul (@ q prm) yB xC))\n                       (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                          (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xB) xC) yB)\n                             yC)))) yA)\n              (@ Opaquediv (@ q prm)\n                 (@ Opaquesub (@ q prm) (@ Opaquemul (@ q prm) yB yC) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) xB) xC))\n                 (@ Opaquesub (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                    (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xB) xC) yB) yC))))))\n     (@ Opaquediv (@ q prm)\n        (@ Opaqueadd (@ q prm)\n           (@ Opaquemul (@ q prm)\n              (@ Opaquediv (@ q prm) (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) xA yB) (@ Opaquemul (@ q prm) yA xB))\n                 (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                    (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xA) xB) yA) yB)))\n              yC)\n           (@ Opaquemul (@ q prm)\n              (@ Opaquediv (@ q prm)\n                 (@ Opaquesub (@ q prm) (@ Opaquemul (@ q prm) yA yB) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) xA) xB))\n                 (@ Opaquesub (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                    (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xA) xB) yA) yB)))\n              xC))\n        (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n           (@ Opaquemul (@ q prm)\n              (@ Opaquemul (@ q prm)\n                 (@ Opaquemul (@ q prm)\n                    (@ Opaquemul (@ q prm) (@ d prm)\n                       (@ Opaquediv (@ q prm) (@ Opaqueadd (@ q prm) (@ Opaquemul (@ q prm) xA yB) (@ Opaquemul (@ q prm) yA xB))\n                          (@ Opaqueadd (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                             (@ Opaquemul (@ q prm)\n                                (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xA) xB) yA) yB)))) xC)\n                 (@ Opaquediv (@ q prm)\n                    (@ Opaquesub (@ q prm) (@ Opaquemul (@ q prm) yA yB) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ a prm) xA) xB))\n                    (@ Opaquesub (@ q prm) (@ OpaqueZToField (@ q prm) (Zpos xH))\n                       (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ Opaquemul (@ q prm) (@ d prm) xA) xB) yA) yB))))\n              yC))).\n  intros.\n  Timeout 1 field_simplify_eq_idtac.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543389","html_url":"https://github.com/coq/coq/issues/4809#issuecomment-337543389","issue_url":"https://api.github.com/repos/coq/coq/issues/4809","id":337543389,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU0MzM4OQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-24T13:00:24Z","updated_at":"2017-10-18T10:28:54Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nThis seems to have been fixed in trunk (59f225510). Are you willing to find where using a bissect so that we can port back the fix to 8.5?\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543391","html_url":"https://github.com/coq/coq/issues/4809#issuecomment-337543391","issue_url":"https://api.github.com/repos/coq/coq/issues/4809","id":337543391,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU0MzM5MQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-24T13:21:11Z","updated_at":"2017-10-18T10:28:54Z","author_association":"CONTRIBUTOR","body":"Comment author: @ppedrot\n\nActually, it even looks like it is fixed in 8.5-dev (4b4397e1). I'll close it.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]