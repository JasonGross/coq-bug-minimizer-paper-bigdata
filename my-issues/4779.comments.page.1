[{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543035","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-337543035","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":337543035,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU0MzAzNQ==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-04T04:16:27Z","updated_at":"2017-10-18T10:27:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nCreated attachment 717\nexample of `change` being slow in src/Parsers/Refinement/SharpenedExpressionPlusParen.v\n\nIn the attached development (compatible with 8.4pl{2,3,4,5,6} and 8.5pl1, based on which _CoqProject is used (either _CoqProject.v85 or _CoqProject.v84)), `Time refine_binop_table.` gives the following profiles in Coq 8.4:\n\nwith [pose y as x; change y with x in H]:\ntotal time:     70.236s\n\n tactic                                    self  total   calls       max\n────────────────────────────────────────┴──────┴──────┴───────┴─────────┘\n─setoid_rewrite_refine_binop_table_idx -   0.5% 100.0%       1   70.236s\n─refine_binop_table --------------------   0.0% 100.0%       1   70.236s\n─replace_with_at_by --------------------   0.0%  98.9%       1   69.492s\n─set_tac -------------------------------   0.0%  98.8%       1   69.424s\n─change x with x' in H -----------------  98.8%  98.8%       1   69.420s\n\n tactic                                    self  total   calls       max\n────────────────────────────────────────┴──────┴──────┴───────┴─────────┘\n─refine_binop_table --------------------   0.0% 100.0%       1   70.236s\n└setoid_rewrite_refine_binop_table_idx -   0.5% 100.0%       1   70.236s\n└replace_with_at_by --------------------   0.0%  98.9%       1   69.492s\n└set_tac -------------------------------   0.0%  98.8%       1   69.424s\n└change x with x' in H -----------------  98.8%  98.8%       1   69.420s\n\n\nwith [set (x := y) in H]:\ntotal time:      0.912s\n\n tactic                                    self  total   calls       max\n────────────────────────────────────────┴──────┴──────┴───────┴─────────┘\n─refine_binop_table --------------------   0.4% 100.0%       1    0.912s\n─setoid_rewrite_refine_binop_table_idx -  38.2%  99.6%       1    0.908s\n─setoid_rewrite H ----------------------  29.4%  39.0%       1    0.356s\n─replace_with_at_by --------------------   0.0%  14.0%       1    0.128s\n─replace_with_vm_compute_in ------------   0.0%  14.0%       1    0.128s\n─replace c with c' in H by (clear; my_vm   0.0%  14.0%       1    0.128s\n─params --------------------------------   0.0%   7.5%       4    0.020s\n─induction H ---------------------------   6.1%   6.1%       1    0.056s\n─set_tac -------------------------------   0.4%   5.7%       1    0.052s\n─set (x' := x) in H --------------------   5.3%   5.3%       1    0.048s\n─assert (Params m' v) as H by typeclasse   0.0%   3.1%       4    0.008s\n─typeclasses eauto ---------------------   3.1%   3.1%       4    0.008s\n─clear n -------------------------------   3.1%   3.1%       4    0.008s\n─pose proof lem as H -------------------   2.6%   2.6%       1    0.024s\n─assert T0 as H0 by (clear; lazy beta io   0.0%   2.2%       1    0.020s\n─clear ---------------------------------   2.2%   2.2%       2    0.016s\n\n tactic                                    self  total   calls       max\n────────────────────────────────────────┴──────┴──────┴───────┴─────────┘\n─refine_binop_table --------------------   0.4% 100.0%       1    0.912s\n└setoid_rewrite_refine_binop_table_idx -  38.2%  99.6%       1    0.908s\n ├─setoid_rewrite H --------------------  29.4%  39.0%       1    0.356s\n │└params ------------------------------   0.0%   7.5%       4    0.020s\n │ ├─assert (Params m' v) as H by typecl   0.0%   3.1%       4    0.008s\n │ │└typeclasses eauto -----------------   3.1%   3.1%       4    0.008s\n │ └─clear n ---------------------------   3.1%   3.1%       4    0.008s\n ├─replace_with_vm_compute_in ----------   0.0%  14.0%       1    0.128s\n │└replace c with c' in H by (clear; my_   0.0%  14.0%       1    0.128s\n │└replace_with_at_by ------------------   0.0%  14.0%       1    0.128s\n │ ├─induction H -----------------------   6.1%   6.1%       1    0.056s\n │ └─set_tac ---------------------------   0.4%   5.7%       1    0.052s\n │  └set (x' := x) in H ----------------   5.3%   5.3%       1    0.048s\n ├─pose proof lem as H -----------------   2.6%   2.6%       1    0.024s\n └─assert T0 as H0 by (clear; lazy beta    0.0%   2.2%       1    0.020s\n\n\nThe times are similar (within a factor of 2 or so) in Coq 8.5.\n\nWhat is [change] doing?!\n\n> Attached file: [slow_set.zip](https://coq.inria.fr/bugfiles/attachment.cgi?id=717) (application/zip, 424194 bytes)\n> Description:   example of `change` being slow in src/Parsers/Refinement/SharpenedExpressionPlusParen.v\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543037","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-337543037","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":337543037,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNzU0MzAzNw==","user":{"login":"coqbot","id":13040781,"node_id":"MDQ6VXNlcjEzMDQwNzgx","avatar_url":"https://avatars.githubusercontent.com/u/13040781?v=4","gravatar_id":"","url":"https://api.github.com/users/coqbot","html_url":"https://github.com/coqbot","followers_url":"https://api.github.com/users/coqbot/followers","following_url":"https://api.github.com/users/coqbot/following{/other_user}","gists_url":"https://api.github.com/users/coqbot/gists{/gist_id}","starred_url":"https://api.github.com/users/coqbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coqbot/subscriptions","organizations_url":"https://api.github.com/users/coqbot/orgs","repos_url":"https://api.github.com/users/coqbot/repos","events_url":"https://api.github.com/users/coqbot/events{/privacy}","received_events_url":"https://api.github.com/users/coqbot/received_events","type":"User","site_admin":false},"created_at":"2016-06-04T04:24:16Z","updated_at":"2017-10-18T10:27:38Z","author_association":"CONTRIBUTOR","body":"Comment author: @JasonGross\n\nNote also that if you use [change] rather than [set] in src/Parsers/Refinement/SharpenedJSON.v, by adding\n\nLtac replace_with_vm_compute_in c H ::=\n  let c' := (my_eval_vm_compute_in c) in\n  (* By constrast [set ... in ...] seems faster than [change .. with ... in ...] in 8.4?! *)\n  let set_tac := (fun x' x\n                  => pose x as x';\n                     change x with x' in H) in\n  replace_with_at_by c c' set_tac ltac:(clear; my_vm_cast_no_check (eq_refl c')).\n\nbefore [Section IndexedImpl.], [Time rewrite_disjoint_search_for.] will thrash your machine and blow through *64 GB* of RAM before crashing Coq, after maybe 15 minutes or so.  By contrast, using [set] takes at most 0.2 s!  Something is seriously wrong with [change] here.\n\n","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/337543037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/930329093","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-930329093","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":930329093,"node_id":"IC_kwDOABUDh843c7IF","user":{"login":"SkySkimmer","id":2461932,"node_id":"MDQ6VXNlcjI0NjE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/2461932?v=4","gravatar_id":"","url":"https://api.github.com/users/SkySkimmer","html_url":"https://github.com/SkySkimmer","followers_url":"https://api.github.com/users/SkySkimmer/followers","following_url":"https://api.github.com/users/SkySkimmer/following{/other_user}","gists_url":"https://api.github.com/users/SkySkimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/SkySkimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkySkimmer/subscriptions","organizations_url":"https://api.github.com/users/SkySkimmer/orgs","repos_url":"https://api.github.com/users/SkySkimmer/repos","events_url":"https://api.github.com/users/SkySkimmer/events{/privacy}","received_events_url":"https://api.github.com/users/SkySkimmer/received_events","type":"User","site_admin":false},"created_at":"2021-09-29T16:18:25Z","updated_at":"2021-09-29T16:18:25Z","author_association":"CONTRIBUTOR","body":"Duplicate https://github.com/coq/coq/issues/4636","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/930329093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331036","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-930331036","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":930331036,"node_id":"IC_kwDOABUDh843c7mc","user":{"login":"ejgallego","id":7192257,"node_id":"MDQ6VXNlcjcxOTIyNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7192257?v=4","gravatar_id":"","url":"https://api.github.com/users/ejgallego","html_url":"https://github.com/ejgallego","followers_url":"https://api.github.com/users/ejgallego/followers","following_url":"https://api.github.com/users/ejgallego/following{/other_user}","gists_url":"https://api.github.com/users/ejgallego/gists{/gist_id}","starred_url":"https://api.github.com/users/ejgallego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejgallego/subscriptions","organizations_url":"https://api.github.com/users/ejgallego/orgs","repos_url":"https://api.github.com/users/ejgallego/repos","events_url":"https://api.github.com/users/ejgallego/events{/privacy}","received_events_url":"https://api.github.com/users/ejgallego/received_events","type":"User","site_admin":false},"created_at":"2021-09-29T16:20:37Z","updated_at":"2021-09-29T16:20:37Z","author_association":"MEMBER","body":"@SkySkimmer the correct Github syntax is:\r\n\r\nDuplicate of #4636 ","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331319","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-930331319","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":930331319,"node_id":"IC_kwDOABUDh843c7q3","user":{"login":"ejgallego","id":7192257,"node_id":"MDQ6VXNlcjcxOTIyNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7192257?v=4","gravatar_id":"","url":"https://api.github.com/users/ejgallego","html_url":"https://github.com/ejgallego","followers_url":"https://api.github.com/users/ejgallego/followers","following_url":"https://api.github.com/users/ejgallego/following{/other_user}","gists_url":"https://api.github.com/users/ejgallego/gists{/gist_id}","starred_url":"https://api.github.com/users/ejgallego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejgallego/subscriptions","organizations_url":"https://api.github.com/users/ejgallego/orgs","repos_url":"https://api.github.com/users/ejgallego/repos","events_url":"https://api.github.com/users/ejgallego/events{/privacy}","received_events_url":"https://api.github.com/users/ejgallego/received_events","type":"User","site_admin":false},"created_at":"2021-09-29T16:20:56Z","updated_at":"2021-09-29T16:20:56Z","author_association":"MEMBER","body":"Duplicate of #4636\r\n\r\n[and it has to appear in the first line, grrrr]","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331598","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-930331598","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":930331598,"node_id":"IC_kwDOABUDh843c7vO","user":{"login":"ejgallego","id":7192257,"node_id":"MDQ6VXNlcjcxOTIyNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7192257?v=4","gravatar_id":"","url":"https://api.github.com/users/ejgallego","html_url":"https://github.com/ejgallego","followers_url":"https://api.github.com/users/ejgallego/followers","following_url":"https://api.github.com/users/ejgallego/following{/other_user}","gists_url":"https://api.github.com/users/ejgallego/gists{/gist_id}","starred_url":"https://api.github.com/users/ejgallego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejgallego/subscriptions","organizations_url":"https://api.github.com/users/ejgallego/orgs","repos_url":"https://api.github.com/users/ejgallego/repos","events_url":"https://api.github.com/users/ejgallego/events{/privacy}","received_events_url":"https://api.github.com/users/ejgallego/received_events","type":"User","site_admin":false},"created_at":"2021-09-29T16:21:14Z","updated_at":"2021-09-29T16:21:14Z","author_association":"MEMBER","body":"Duplicate of #4636","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331802","html_url":"https://github.com/coq/coq/issues/4779#issuecomment-930331802","issue_url":"https://api.github.com/repos/coq/coq/issues/4779","id":930331802,"node_id":"IC_kwDOABUDh843c7ya","user":{"login":"ejgallego","id":7192257,"node_id":"MDQ6VXNlcjcxOTIyNTc=","avatar_url":"https://avatars.githubusercontent.com/u/7192257?v=4","gravatar_id":"","url":"https://api.github.com/users/ejgallego","html_url":"https://github.com/ejgallego","followers_url":"https://api.github.com/users/ejgallego/followers","following_url":"https://api.github.com/users/ejgallego/following{/other_user}","gists_url":"https://api.github.com/users/ejgallego/gists{/gist_id}","starred_url":"https://api.github.com/users/ejgallego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejgallego/subscriptions","organizations_url":"https://api.github.com/users/ejgallego/orgs","repos_url":"https://api.github.com/users/ejgallego/repos","events_url":"https://api.github.com/users/ejgallego/events{/privacy}","received_events_url":"https://api.github.com/users/ejgallego/received_events","type":"User","site_admin":false},"created_at":"2021-09-29T16:21:28Z","updated_at":"2021-09-29T16:21:28Z","author_association":"MEMBER","body":"Seems it has to appear alone, grrrrr","reactions":{"url":"https://api.github.com/repos/coq/coq/issues/comments/930331802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]