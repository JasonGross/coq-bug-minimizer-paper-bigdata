{"id":66761543,"status":"success","stage":"test","name":"ci-vst","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:25.797Z","started_at":"2018-05-06T22:08:31.477Z","finished_at":"2018-05-06T23:14:51.607Z","duration":3980.13065,"queued_duration":5.809533,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761543","artifacts":[{"file_type":"trace","size":156668,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761542,"status":"success","stage":"test","name":"ci-unimath","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:25.761Z","started_at":"2018-05-06T22:08:31.247Z","finished_at":"2018-05-06T22:19:52.671Z","duration":681.424516,"queued_duration":5.512737,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761542","artifacts":[{"file_type":"trace","size":99917,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761541,"status":"success","stage":"test","name":"ci-sf","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:25.729Z","started_at":"2018-05-06T22:08:31.123Z","finished_at":"2018-05-06T22:13:33.706Z","duration":302.583435,"queued_duration":5.278999,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761541","artifacts":[{"file_type":"trace","size":255770,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761540,"status":"success","stage":"test","name":"ci-pidetop","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:25.523Z","started_at":"2018-05-06T22:08:26.172Z","finished_at":"2018-05-06T22:11:17.238Z","duration":171.066326,"queued_duration":0.22264,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761540","artifacts":[{"file_type":"trace","size":27335,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761539,"status":"success","stage":"test","name":"ci-mtac2","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:25.377Z","started_at":"2018-05-06T22:08:30.999Z","finished_at":"2018-05-06T22:12:43.345Z","duration":252.345888,"queued_duration":4.940216,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761539","artifacts":[{"file_type":"trace","size":76305,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761538,"status":"success","stage":"test","name":"ci-math-comp","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:25.134Z","started_at":"2018-05-06T22:08:30.655Z","finished_at":"2018-05-06T22:26:52.304Z","duration":1101.649289,"queued_duration":4.523166,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761538","artifacts":[{"file_type":"trace","size":210418,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761536,"status":"success","stage":"test","name":"ci-math-classes","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:24.906Z","started_at":"2018-05-06T22:08:26.329Z","finished_at":"2018-05-06T22:20:10.996Z","duration":704.66684,"queued_duration":0.130714,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761536","artifacts":[{"file_type":"trace","size":138320,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761534,"status":"success","stage":"test","name":"ci-ltac2","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:24.825Z","started_at":"2018-05-06T22:08:30.455Z","finished_at":"2018-05-06T22:12:12.670Z","duration":222.215151,"queued_duration":4.176376,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761534","artifacts":[{"file_type":"trace","size":31807,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761532,"status":"success","stage":"test","name":"ci-iris-lambda-rust","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:24.737Z","started_at":"2018-05-06T22:08:30.281Z","finished_at":"2018-05-06T23:24:33.209Z","duration":4562.927429,"queued_duration":3.921577,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761532","artifacts":[{"file_type":"trace","size":181606,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761530,"status":"success","stage":"test","name":"ci-hott","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:24.576Z","started_at":"2018-05-06T22:08:30.173Z","finished_at":"2018-05-06T22:18:57.228Z","duration":627.0548,"queued_duration":3.760932,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761530","artifacts":[{"file_type":"trace","size":52078,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761529,"status":"success","stage":"test","name":"ci-geocoq","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:24.299Z","started_at":"2018-05-06T22:08:26.720Z","finished_at":"2018-05-06T23:01:52.240Z","duration":3205.520185,"queued_duration":0.228656,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761529","artifacts":[{"file_type":"trace","size":119335,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761528,"status":"success","stage":"test","name":"ci-formal-topology","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:24.001Z","started_at":"2018-05-06T22:08:29.854Z","finished_at":"2018-05-06T22:34:45.334Z","duration":1575.480655,"queued_duration":3.244128,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761528","artifacts":[{"file_type":"trace","size":553592,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761527,"status":"success","stage":"test","name":"ci-flocq","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:23.643Z","started_at":"2018-05-06T22:08:29.709Z","finished_at":"2018-05-06T22:18:02.270Z","duration":572.560962,"queued_duration":2.985364,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761527","artifacts":[{"file_type":"trace","size":640266,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761525,"status":"success","stage":"test","name":"ci-fiat-parsers","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:23.318Z","started_at":"2018-05-06T22:08:27.149Z","finished_at":"2018-05-06T22:21:51.544Z","duration":804.395683,"queued_duration":0.290384,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761525","artifacts":[{"file_type":"trace","size":225192,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761524,"status":"success","stage":"test","name":"ci-fcsl-pcm","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:23.102Z","started_at":"2018-05-06T22:08:29.547Z","finished_at":"2018-05-06T22:13:17.681Z","duration":288.134237,"queued_duration":2.59169,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761524","artifacts":[{"file_type":"trace","size":63856,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761523,"status":"success","stage":"test","name":"ci-equations","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:22.829Z","started_at":"2018-05-06T22:08:29.438Z","finished_at":"2018-05-06T22:13:22.823Z","duration":293.384978,"queued_duration":2.417468,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761523","artifacts":[{"file_type":"trace","size":71660,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761522,"status":"success","stage":"test","name":"ci-elpi","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:22.618Z","started_at":"2018-05-06T22:08:29.337Z","finished_at":"2018-05-06T22:12:40.720Z","duration":251.383222,"queued_duration":2.227955,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761522","artifacts":[{"file_type":"trace","size":354855,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761521,"status":"success","stage":"test","name":"ci-coquelicot","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:22.399Z","started_at":"2018-05-06T22:08:29.174Z","finished_at":"2018-05-06T22:13:30.905Z","duration":301.731204,"queued_duration":1.965368,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761521","artifacts":[{"file_type":"trace","size":68267,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761520,"status":"success","stage":"test","name":"ci-coq-dpdgraph","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:22.211Z","started_at":"2018-05-06T22:08:28.036Z","finished_at":"2018-05-06T22:11:48.624Z","duration":200.587762,"queued_duration":0.74628,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761520","artifacts":[{"file_type":"trace","size":28651,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761519,"status":"success","stage":"test","name":"ci-compcert","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:22.030Z","started_at":"2018-05-06T22:08:27.790Z","finished_at":"2018-05-06T22:31:24.985Z","duration":1377.195502,"queued_duration":0.414068,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761519","artifacts":[{"file_type":"trace","size":1987991,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761518,"status":"success","stage":"test","name":"ci-color","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:21.974Z","started_at":"2018-05-06T22:08:27.689Z","finished_at":"2018-05-06T23:11:18.119Z","duration":3770.429492,"queued_duration":0.211791,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761518","artifacts":[{"file_type":"trace","size":274379,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761517,"status":"success","stage":"test","name":"ci-bignums","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:21.919Z","started_at":"2018-05-06T22:08:28.444Z","finished_at":"2018-05-06T22:13:26.418Z","duration":297.973902,"queued_duration":0.871424,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761517","artifacts":[{"file_type":"trace","size":29907,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761516,"status":"success","stage":"test","name":"validate:32bit","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:21.839Z","started_at":"2018-05-06T22:08:28.280Z","finished_at":"2018-05-06T22:18:06.556Z","duration":578.275448,"queued_duration":0.634217,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761516","artifacts":[{"file_type":"trace","size":14111,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761515,"status":"success","stage":"test","name":"validate","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:21.596Z","started_at":"2018-05-06T22:08:28.002Z","finished_at":"2018-05-06T22:17:10.691Z","duration":522.688208,"queued_duration":0.214943,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761515","artifacts":[{"file_type":"trace","size":16308,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761514,"status":"success","stage":"test","name":"test-suite:bleeding-edge","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:21.284Z","started_at":"2018-05-06T22:08:28.091Z","finished_at":"2018-05-06T22:19:18.565Z","duration":650.474425,"queued_duration":0.184343,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761514","artifacts":[{"file_type":"trace","size":54888,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761513,"status":"success","stage":"test","name":"test-suite:32bit","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:21.155Z","started_at":"2018-05-06T22:08:29.027Z","finished_at":"2018-05-06T22:15:19.594Z","duration":410.566893,"queued_duration":1.018864,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761513","artifacts":[{"file_type":"trace","size":55897,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761512,"status":"success","stage":"test","name":"test-suite","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:20.919Z","started_at":"2018-05-06T22:08:28.233Z","finished_at":"2018-05-06T22:14:58.674Z","duration":390.440721,"queued_duration":0.11692,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761512","artifacts":[{"file_type":"trace","size":57060,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":66761511,"status":"success","stage":"test","name":"warnings:bleeding-edge","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:20.733Z","started_at":"2018-05-06T22:08:28.504Z","finished_at":"2018-05-06T22:14:20.109Z","duration":351.60522,"queued_duration":0.285389,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761511","artifacts":[{"file_type":"trace","size":62902,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761510,"status":"success","stage":"test","name":"warnings","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:20.470Z","started_at":"2018-05-06T22:08:28.887Z","finished_at":"2018-05-06T22:13:57.593Z","duration":328.706164,"queued_duration":0.506248,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761510","artifacts":[{"file_type":"trace","size":48735,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":66761509,"status":"success","stage":"build","name":"build:bleeding-edge","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:20.253Z","started_at":"2018-05-06T21:49:13.812Z","finished_at":"2018-05-06T21:59:02.212Z","duration":588.399833,"queued_duration":1.331271,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761509","artifacts":[{"file_type":"trace","size":220452,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":"2018-05-13T21:59:00.748Z","tag_list":[]}
{"id":66761508,"status":"success","stage":"build","name":"build:32bit","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:20.014Z","started_at":"2018-05-06T21:49:13.546Z","finished_at":"2018-05-06T22:00:06.789Z","duration":653.242967,"queued_duration":0.940319,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761508","artifacts":[{"file_type":"trace","size":216098,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":"2018-05-13T22:00:05.809Z","tag_list":[]}
{"id":66761507,"status":"success","stage":"build","name":"build","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:19.893Z","started_at":"2018-05-06T21:49:13.440Z","finished_at":"2018-05-06T22:08:25.501Z","duration":1152.060397,"queued_duration":0.733417,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761507","artifacts":[{"file_type":"trace","size":276135,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2018-05-13T22:08:24.142Z","tag_list":[]}
{"id":66761506,"status":"success","stage":"docker","name":"docker-boot","ref":"pr-7442","tag":false,"coverage":null,"allow_failure":false,"created_at":"2018-05-06T21:46:19.819Z","started_at":"2018-05-06T21:46:31.404Z","finished_at":"2018-05-06T21:49:12.357Z","duration":160.953529,"queued_duration":1.473015,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","short_id":"e5a1b22c","created_at":"2018-05-06T23:45:11.000+02:00","parent_ids":["cee82a36b21c7a87fe4f626d8d72fd938a825648"],"title":"Gitlab: build docker image in pipeline and use througn registry.","message":"Gitlab: build docker image in pipeline and use througn registry.\n\nA docker-boot job is added which builds the docker image and pushes it\nto the registry, the other jobs running on the image from the\nregistry.\n\nThe boot job reuses the already pushed image if it exists and matches,\nthis is important to cut down its runtime.\n\nMaking a new image takes 30min for all the switches\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66650546\nFor testing I removed all jobs except boot and main build, and after\nthat run I built only the standard switch.\n\nBuilding 1 switch takes around 20min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66656942\nWhen the registry is up to date it takes 2min\nhttps://gitlab.com/SkySkimmer/coq/-/jobs/66658790\n(I don't know about all switches but probably no more than 5min)\n\nEach pipeline pushes the image to $CI_REGISTRY_IMAGE:$CI_PIPELINE_ID\nwhich is eg registry.gitlab.com/skyskimmer/coq:21557176 and is what\nthe other jobs use to run themselves.\n\nFor caching it pulls from and pushes to a constant name, in this test\n$CI_REGISTRY_IMAGE:$CACHEKEY. We might also want to pull from the main\ncoq repo to avoid redoing work.\n\nThe question of having 1 image or 1 image/switch remains open.\n\nUsing the gitlab registry doesn't really work for circle CI, so the\ndockerhub account would have to remain (or circle could return to an\nopam-boot job, or be removed from our CI). There are similar concerns\nwith travis if we want to move it to docker.\n","author_name":"Gaëtan Gilbert","author_email":"gaetan.gilbert@skyskimmer.net","authored_date":"2018-05-05T13:14:10.000+02:00","committer_name":"Gaëtan Gilbert","committer_email":"gaetan.gilbert@skyskimmer.net","committed_date":"2018-05-06T23:45:11.000+02:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e"},"pipeline":{"id":21595139,"iid":null,"project_id":6138686,"sha":"e5a1b22c50ab12bf271c0337e1d12458eb8f6e7e","ref":"pr-7442","status":"success","source":"push","created_at":"2018-05-06T21:46:19.740Z","updated_at":"2018-05-06T23:24:33.455Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/21595139"},"web_url":"https://gitlab.com/coq/coq/-/jobs/66761506","artifacts":[{"file_type":"trace","size":8700,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
