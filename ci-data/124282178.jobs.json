{"id":463498123,"status":"failed","stage":"stage-4","name":"library:ci-corn","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.349Z","started_at":"2020-03-08T09:41:04.568Z","finished_at":"2020-03-08T09:43:24.862Z","duration":140.293762,"queued_duration":0.708168,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"failure_reason":"script_failure","web_url":"https://gitlab.com/coq/coq/-/jobs/463498123","artifacts":[{"file_type":"trace","size":660418,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498122,"status":"success","stage":"stage-4","name":"library:ci-fiat-crypto","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.325Z","started_at":"2020-03-08T09:48:44.360Z","finished_at":"2020-03-08T11:48:24.215Z","duration":7179.855526,"queued_duration":0.562637,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498122","artifacts":[{"file_type":"trace","size":358779,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498121,"status":"success","stage":"stage-3","name":"library:ci-math-classes","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.302Z","started_at":"2020-03-08T09:35:13.420Z","finished_at":"2020-03-08T09:41:03.604Z","duration":350.183602,"queued_duration":1.913934,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498121","artifacts":[{"file_type":"trace","size":215221,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498120,"status":"success","stage":"stage-3","name":"library:ci-coqprime","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.279Z","started_at":"2020-03-08T09:35:12.267Z","finished_at":"2020-03-08T09:41:23.265Z","duration":370.998145,"queued_duration":0.885585,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498120","artifacts":[{"file_type":"trace","size":100706,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498119,"status":"success","stage":"stage-3","name":"library:ci-color","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.259Z","started_at":"2020-03-08T09:35:12.124Z","finished_at":"2020-03-08T09:55:48.522Z","duration":1236.398224,"queued_duration":0.831639,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498119","artifacts":[{"file_type":"trace","size":254985,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498118,"status":"success","stage":"stage-2","name":"plugin:ci-rewriter","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.232Z","started_at":"2020-03-08T09:32:01.859Z","finished_at":"2020-03-08T09:48:43.646Z","duration":1001.786297,"queued_duration":1.627621,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498118","artifacts":[{"file_type":"trace","size":153859,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498117,"status":"success","stage":"stage-2","name":"plugin:ci-relation_algebra","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.209Z","started_at":"2020-03-08T09:39:38.034Z","finished_at":"2020-03-08T09:46:12.355Z","duration":394.321397,"queued_duration":2.30667,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498117","artifacts":[{"file_type":"trace","size":286540,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498116,"status":"success","stage":"stage-2","name":"plugin:ci-reduction_effects","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.187Z","started_at":"2020-03-08T09:39:37.991Z","finished_at":"2020-03-08T09:43:29.138Z","duration":231.146703,"queued_duration":2.320782,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498116","artifacts":[{"file_type":"trace","size":41885,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498115,"status":"success","stage":"stage-2","name":"plugin:ci-quickchick","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.165Z","started_at":"2020-03-08T09:32:01.760Z","finished_at":"2020-03-08T09:38:19.816Z","duration":378.05642,"queued_duration":1.585668,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498115","artifacts":[{"file_type":"trace","size":322951,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498114,"status":"success","stage":"stage-2","name":"plugin:ci-perennial","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.146Z","started_at":"2020-03-08T09:32:01.681Z","finished_at":"2020-03-08T10:08:10.982Z","duration":2169.301032,"queued_duration":1.562644,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498114","artifacts":[{"file_type":"trace","size":48945,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498113,"status":"success","stage":"stage-2","name":"plugin:ci-paramcoq","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.126Z","started_at":"2020-03-08T09:39:37.896Z","finished_at":"2020-03-08T09:42:18.801Z","duration":160.905357,"queued_duration":2.287719,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498113","artifacts":[{"file_type":"trace","size":116344,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498112,"status":"success","stage":"stage-2","name":"plugin:ci-mtac2","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.105Z","started_at":"2020-03-08T09:39:37.844Z","finished_at":"2020-03-08T09:44:45.631Z","duration":307.786982,"queued_duration":2.288219,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498112","artifacts":[{"file_type":"trace","size":164802,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498111,"status":"success","stage":"stage-2","name":"plugin:ci-fiat_parsers","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.086Z","started_at":"2020-03-08T09:39:37.804Z","finished_at":"2020-03-08T09:59:11.527Z","duration":1173.72258,"queued_duration":2.29839,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498111","artifacts":[{"file_type":"trace","size":250312,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498110,"status":"success","stage":"stage-2","name":"plugin:ci-equations","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.065Z","started_at":"2020-03-08T09:39:37.557Z","finished_at":"2020-03-08T09:46:53.050Z","duration":435.4925,"queued_duration":2.104028,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498110","artifacts":[{"file_type":"trace","size":129575,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498109,"status":"success","stage":"stage-2","name":"plugin:ci-elpi","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.043Z","started_at":"2020-03-08T09:39:37.471Z","finished_at":"2020-03-08T09:45:16.001Z","duration":338.529242,"queued_duration":2.0675,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498109","artifacts":[{"file_type":"trace","size":293066,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498108,"status":"success","stage":"stage-2","name":"plugin:ci-coqhammer","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.024Z","started_at":"2020-03-08T09:39:37.434Z","finished_at":"2020-03-08T09:42:05.054Z","duration":147.619584,"queued_duration":2.081847,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498108","artifacts":[{"file_type":"trace","size":73778,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498107,"status":"success","stage":"stage-2","name":"plugin:ci-coq_dpdgraph","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:02.006Z","started_at":"2020-03-08T09:39:37.357Z","finished_at":"2020-03-08T09:43:23.147Z","duration":225.789814,"queued_duration":2.054866,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498107","artifacts":[{"file_type":"trace","size":54316,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498106,"status":"success","stage":"stage-2","name":"plugin:ci-bignums","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.987Z","started_at":"2020-03-08T09:32:01.415Z","finished_at":"2020-03-08T09:35:11.152Z","duration":189.736407,"queued_duration":1.352685,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498106","artifacts":[{"file_type":"trace","size":83902,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498105,"status":"success","stage":"stage-2","name":"plugin:ci-aac_tactics","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.967Z","started_at":"2020-03-08T09:39:37.312Z","finished_at":"2020-03-08T09:43:34.158Z","duration":236.846528,"queued_duration":2.066808,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498105","artifacts":[{"file_type":"trace","size":58858,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498104,"status":"failed","stage":"stage-2","name":"library:ci-vst","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.949Z","started_at":"2020-03-08T09:32:01.308Z","finished_at":"2020-03-08T10:12:49.505Z","duration":2448.196425,"queued_duration":1.302427,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"failure_reason":"script_failure","web_url":"https://gitlab.com/coq/coq/-/jobs/463498104","artifacts":[{"file_type":"trace","size":198100,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498103,"status":"success","stage":"stage-2","name":"library:ci-verdi-raft","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.931Z","started_at":"2020-03-08T09:32:01.220Z","finished_at":"2020-03-08T10:10:29.350Z","duration":2308.129689,"queued_duration":1.268107,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498103","artifacts":[{"file_type":"trace","size":186511,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498102,"status":"success","stage":"stage-2","name":"library:ci-unimath","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.914Z","started_at":"2020-03-08T09:32:01.124Z","finished_at":"2020-03-08T11:04:20.035Z","duration":5538.911821,"queued_duration":1.224716,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498102","artifacts":[{"file_type":"trace","size":224621,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498101,"status":"success","stage":"stage-2","name":"library:ci-tlc","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.895Z","started_at":"2020-03-08T09:39:37.260Z","finished_at":"2020-03-08T09:45:04.828Z","duration":327.567699,"queued_duration":2.065577,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498101","artifacts":[{"file_type":"trace","size":44109,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498100,"status":"success","stage":"stage-2","name":"library:ci-stdlib2","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.877Z","started_at":"2020-03-08T09:32:01.029Z","finished_at":"2020-03-08T09:36:10.473Z","duration":249.444612,"queued_duration":1.184044,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498100","artifacts":[{"file_type":"trace","size":47558,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498099,"status":"success","stage":"stage-2","name":"library:ci-sf","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.858Z","started_at":"2020-03-08T09:39:37.187Z","finished_at":"2020-03-08T09:45:13.073Z","duration":335.886298,"queued_duration":2.050971,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498099","artifacts":[{"file_type":"trace","size":444176,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498098,"status":"success","stage":"stage-2","name":"library:ci-math-comp","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.839Z","started_at":"2020-03-08T09:32:00.958Z","finished_at":"2020-03-08T11:10:24.608Z","duration":5903.64986,"queued_duration":1.16603,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498098","artifacts":[{"file_type":"trace","size":429459,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498097,"status":"success","stage":"stage-2","name":"library:ci-iris-lambda-rust","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.821Z","started_at":"2020-03-08T09:32:00.847Z","finished_at":"2020-03-08T10:26:32.565Z","duration":3271.718179,"queued_duration":1.108202,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498097","artifacts":[{"file_type":"trace","size":365676,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498096,"status":"success","stage":"stage-2","name":"library:ci-hott","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.803Z","started_at":"2020-03-08T09:39:36.977Z","finished_at":"2020-03-08T09:53:11.866Z","duration":814.889475,"queued_duration":1.889226,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498096","artifacts":[{"file_type":"trace","size":140676,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498095,"status":"success","stage":"stage-2","name":"library:ci-geocoq","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.785Z","started_at":"2020-03-08T09:32:00.807Z","finished_at":"2020-03-08T10:17:34.561Z","duration":2733.754926,"queued_duration":1.120643,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498095","artifacts":[{"file_type":"trace","size":499196,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498094,"status":"success","stage":"stage-2","name":"library:ci-flocq","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.768Z","started_at":"2020-03-08T09:39:36.923Z","finished_at":"2020-03-08T09:47:16.674Z","duration":459.751059,"queued_duration":1.888906,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498094","artifacts":[{"file_type":"trace","size":44185,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498093,"status":"success","stage":"stage-2","name":"library:ci-fcsl-pcm","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.750Z","started_at":"2020-03-08T09:39:36.879Z","finished_at":"2020-03-08T09:44:58.494Z","duration":321.61408,"queued_duration":1.895027,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498093","artifacts":[{"file_type":"trace","size":152269,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498092,"status":"success","stage":"stage-2","name":"library:ci-cross-crypto","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.730Z","started_at":"2020-03-08T09:39:36.682Z","finished_at":"2020-03-08T10:31:54.362Z","duration":3137.679569,"queued_duration":1.748642,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498092","artifacts":[{"file_type":"trace","size":60337,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498091,"status":"success","stage":"stage-2","name":"library:ci-coquelicot","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.712Z","started_at":"2020-03-08T09:39:36.510Z","finished_at":"2020-03-08T09:46:14.463Z","duration":397.953172,"queued_duration":1.626782,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498091","artifacts":[{"file_type":"trace","size":190418,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498090,"status":"success","stage":"stage-2","name":"library:ci-compcert","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.693Z","started_at":"2020-03-08T09:32:00.729Z","finished_at":"2020-03-08T09:56:52.512Z","duration":1491.783401,"queued_duration":1.092555,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498090","artifacts":[{"file_type":"trace","size":4194361,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498089,"status":"success","stage":"stage-2","name":"library:ci-bedrock2","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.676Z","started_at":"2020-03-08T09:32:00.457Z","finished_at":"2020-03-08T11:24:20.544Z","duration":6740.086891,"queued_duration":0.868175,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498089","artifacts":[{"file_type":"trace","size":346087,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498088,"status":"success","stage":"stage-2","name":"library:ci-argosy","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.659Z","started_at":"2020-03-08T09:39:36.349Z","finished_at":"2020-03-08T09:44:42.103Z","duration":305.754146,"queued_duration":1.513059,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498088","artifacts":[{"file_type":"trace","size":38247,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498087,"status":"failed","stage":"stage-2","name":"validate:quick","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.639Z","started_at":"2020-03-08T09:42:18.677Z","finished_at":"2020-03-08T09:45:13.451Z","duration":174.774396,"queued_duration":0.63217,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"failure_reason":"script_failure","web_url":"https://gitlab.com/coq/coq/-/jobs/463498087","artifacts":[{"file_type":"trace","size":24798,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498086,"status":"success","stage":"stage-2","name":"validate:edge+flambda","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.619Z","started_at":"2020-03-08T09:32:00.156Z","finished_at":"2020-03-08T09:37:18.419Z","duration":318.26355,"queued_duration":0.616655,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498086","artifacts":[{"file_type":"trace","size":75686,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498085,"status":"failed","stage":"stage-2","name":"validate:base+32bit","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.601Z","started_at":"2020-03-08T09:36:58.546Z","finished_at":"2020-03-08T09:37:33.845Z","duration":35.299663,"queued_duration":0.543201,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"failure_reason":"script_failure","web_url":"https://gitlab.com/coq/coq/-/jobs/463498085","artifacts":[{"file_type":"trace","size":52541,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498084,"status":"success","stage":"stage-2","name":"validate:base","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.582Z","started_at":"2020-03-08T09:39:36.119Z","finished_at":"2020-03-08T09:45:12.597Z","duration":336.478638,"queued_duration":1.336977,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498084","artifacts":[{"file_type":"trace","size":75059,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498083,"status":"failed","stage":"stage-2","name":"test-suite:base+async","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":true,"created_at":"2020-03-08T09:23:01.565Z","started_at":"2020-03-08T09:37:13.431Z","finished_at":"2020-03-08T09:40:08.391Z","duration":174.959743,"queued_duration":0.590908,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"failure_reason":"script_failure","web_url":"https://gitlab.com/coq/coq/-/jobs/463498083","artifacts":[{"file_type":"trace","size":75856,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498082,"status":"success","stage":"stage-2","name":"test-suite:edge+flambda","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.546Z","started_at":"2020-03-08T09:32:00.092Z","finished_at":"2020-03-08T10:06:12.288Z","duration":2052.196724,"queued_duration":0.60451,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498082","artifacts":[{"file_type":"trace","size":101633,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498081,"status":"success","stage":"stage-2","name":"test-suite:base+32bit","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.528Z","started_at":"2020-03-08T09:36:58.430Z","finished_at":"2020-03-08T09:55:14.309Z","duration":1095.879635,"queued_duration":0.482539,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498081","artifacts":[{"file_type":"trace","size":123706,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498080,"status":"success","stage":"stage-2","name":"test-suite:base","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.510Z","started_at":"2020-03-08T09:39:35.968Z","finished_at":"2020-03-08T10:12:12.188Z","duration":1956.219542,"queued_duration":1.240359,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498080","artifacts":[{"file_type":"trace","size":100021,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498079,"status":"success","stage":"stage-2","name":"doc:stdlib-html","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.493Z","started_at":"2020-03-08T09:39:35.915Z","finished_at":"2020-03-08T09:43:59.162Z","duration":263.246684,"queued_duration":1.243562,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498079","artifacts":[{"file_type":"trace","size":31460,"filename":"job.log","file_format":null}],"runner":{"id":380986,"description":"shared-runners-manager-5.gitlab.com","ip_address":"34.74.209.140","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2020-05-07T09:43:57.090Z","tag_list":[]}
{"id":463498078,"status":"success","stage":"stage-2","name":"doc:refman-html","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.475Z","started_at":"2020-03-08T09:39:35.786Z","finished_at":"2020-03-08T09:45:46.118Z","duration":370.332173,"queued_duration":1.165667,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498078","artifacts":[{"file_type":"trace","size":31143,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2020-05-07T09:45:44.278Z","tag_list":[]}
{"id":463498077,"status":"success","stage":"stage-2","name":"doc:apidoc","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.456Z","started_at":"2020-03-08T09:39:35.082Z","finished_at":"2020-03-08T09:44:11.691Z","duration":276.609113,"queued_duration":0.516834,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498077","artifacts":[{"file_type":"trace","size":81726,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2020-03-15T09:44:10.517Z","tag_list":[]}
{"id":463498076,"status":"failed","stage":"stage-1","name":"pkg:nix","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.422Z","started_at":"2020-03-08T09:23:05.080Z","finished_at":"2020-03-08T09:27:49.610Z","duration":284.530187,"queued_duration":2.114443,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"failure_reason":"script_failure","web_url":"https://gitlab.com/coq/coq/-/jobs/463498076","artifacts":[{"file_type":"trace","size":73987,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":null,"tag_list":[]}
{"id":463498075,"status":"success","stage":"stage-1","name":"pkg:opam","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.406Z","started_at":"2020-03-08T09:23:05.028Z","finished_at":"2020-03-08T09:47:40.578Z","duration":1475.550119,"queued_duration":2.09344,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498075","artifacts":[{"file_type":"trace","size":26667,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498074,"status":"success","stage":"stage-1","name":"lint","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.390Z","started_at":"2020-03-08T09:23:04.828Z","finished_at":"2020-03-08T09:29:00.752Z","duration":355.923435,"queued_duration":1.918619,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498074","artifacts":[{"file_type":"trace","size":43557,"filename":"job.log","file_format":null}],"runner":{"id":44949,"description":"shared-runners-manager-4.gitlab.com","ip_address":"13.37.237.197","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":null,"tag_list":[]}
{"id":463498073,"status":"success","stage":"stage-1","name":"windows64","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.368Z","started_at":"2020-03-08T09:23:03.289Z","finished_at":"2020-03-08T10:25:47.846Z","duration":3764.556649,"queued_duration":0.402241,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498073","artifacts":[{"file_type":"trace","size":247779,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":"2020-03-15T10:25:46.832Z","tag_list":["windows-inria"]}
{"id":463498072,"status":"success","stage":"stage-1","name":"build:quick","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":true,"created_at":"2020-03-08T09:23:01.350Z","started_at":"2020-03-08T09:23:04.790Z","finished_at":"2020-03-08T09:42:17.936Z","duration":1153.145528,"queued_duration":1.926645,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498072","artifacts":[{"file_type":"trace","size":262592,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2020-03-15T09:42:16.088Z","tag_list":[]}
{"id":463498071,"status":"success","stage":"stage-1","name":"build:base+async","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":true,"created_at":"2020-03-08T09:23:01.330Z","started_at":"2020-03-08T09:23:04.462Z","finished_at":"2020-03-08T10:29:31.349Z","duration":3986.887534,"queued_duration":1.650289,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498071","artifacts":[{"file_type":"trace","size":313592,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":"2020-03-15T10:29:29.012Z","tag_list":[]}
{"id":463498070,"status":"success","stage":"stage-1","name":"build:edge+flambda","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.309Z","started_at":"2020-03-08T09:23:04.370Z","finished_at":"2020-03-08T09:31:59.359Z","duration":534.98857,"queued_duration":1.619541,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498070","artifacts":[{"file_type":"trace","size":51350,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":"2020-03-15T09:31:57.377Z","tag_list":[]}
{"id":463498069,"status":"success","stage":"stage-1","name":"build:base+32bit","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.288Z","started_at":"2020-03-08T09:23:04.166Z","finished_at":"2020-03-08T09:36:57.847Z","duration":833.681054,"queued_duration":1.449835,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498069","artifacts":[{"file_type":"trace","size":23602,"filename":"job.log","file_format":null}],"runner":{"id":380987,"description":"shared-runners-manager-6.gitlab.com","ip_address":"34.74.239.13","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2020-03-15T09:36:56.371Z","tag_list":[]}
{"id":463498068,"status":"success","stage":"stage-1","name":"build:base","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.266Z","started_at":"2020-03-08T09:23:04.022Z","finished_at":"2020-03-08T09:39:34.431Z","duration":990.408907,"queued_duration":1.332934,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498068","artifacts":[{"file_type":"trace","size":24970,"filename":"job.log","file_format":null}],"runner":{"id":44028,"description":"shared-runners-manager-3.gitlab.com","ip_address":"35.196.21.178","active":true,"paused":false,"is_shared":true,"runner_type":"instance_type","name":"gitlab-runner","online":false,"status":"stale"},"artifacts_expire_at":"2020-03-15T09:39:33.080Z","tag_list":[]}
{"id":463498067,"status":"success","stage":"stage-1","name":"build:make:base","ref":"pr-8729","tag":false,"coverage":null,"allow_failure":false,"created_at":"2020-03-08T09:23:01.244Z","started_at":"2020-03-08T09:23:03.820Z","finished_at":"2020-03-08T09:37:12.723Z","duration":848.902852,"queued_duration":1.177479,"user":{"id":2256237,"username":"coqbot","name":"coqbot","state":"active","avatar_url":"https://gitlab.com/uploads/-/system/user/avatar/2256237/avatar.png","web_url":"https://gitlab.com/coqbot","created_at":"2018-04-28T07:53:57.210Z","bio":"Hello, I'm a bot.","location":"","public_email":"","skype":"","linkedin":"","twitter":"","website_url":"","organization":"","job_title":"","pronouns":null,"bot":false,"work_information":null,"followers":0,"following":0,"local_time":null},"commit":{"id":"f59d7939930e057ea5fa6b406418987f189e7dda","short_id":"f59d7939","created_at":"2020-03-08T05:22:47.000-04:00","parent_ids":["dbd3a4c4213b3d56908a8387de93e27aaec501a4"],"title":"[dune] Switch to a Dune-based build system.","message":"[dune] Switch to a Dune-based build system.\n\nOver the last months we have added support to build Coq with Dune, I\nfeel we have reached a point where we can start to discuss if we\nshould replace the make-based system with a Dune-based one.\n\nThe *main rationale* for the switch is that maintaining two build\nsystems is hard, and Dune seems superior to make in almost every\naspect.\n\nIndeed, I think it is going to be hard to find technical arguments to\ndefend the make-base system. Dune outperforms it on almost every\npossible metric.\n\nAdditionally, the make-based system has grew organically over the\nyears, and these days we are spending significant developer resources\non it. The number of bugs that would be fixed by Dune is large [see #8052].\nIt is not a coincidence that few large projects do use `make` anymore,\nbut most have moved to `CMake`, `Ninja`, or some other alternative.\n\nOn this side, Dune provides a well-defined model that seems to git\nCoq's present and future necessities well.\n\n*Blockers*: the single blocker for a merge as of today, apart from the\ndepending PRs, is the lack of native-compute support. It is also\nlikely that we want to add first-class Coq support to Dune before\nmerging this.\n\n*Risk analysis*: it is important to understand the risks that such a\nmove would entail. After Dune support is merged we could always go\nback to a make-based system, however we are very likely to depend on\nDune-specific features that would be hard to replicate. The main risks are:\n\n- lock-in: indeed lock-in risk is significant and Coq's source code\n  may depend on some Dune features. On the other hand, Dune is\n  strongly poised to be the standard build tool for the OCaml platform\n  and ecosystem, and more than 50% of OPAM packages use it.\n\n  It is safe to say that if Dune would become unsupported in the\n  future, there would be more important problems than Coq itself.\n\n- lack of in-house knowledge: indeed, Dune requires some specific\n  training in order to understand its build rules, which may become a\n  problem. This risk is mitigated in 2 different ways and attenuated\n  by an additional consideration: first, Dune rules are fairly simple\n  and declarative and it is reasonable to expect developers get to\n  know them without too much effort. This is one of the reasons for\n  the high adoption numbers in the ecosystem. Second, Dune developers\n  are very reactive and care about Coq, thus it is safe to assume that\n  we would get external help if needed. The additional consideration\n  that may make this less of a problem is that our in-house knowledge\n  of make may be even worse than Dune's. A non-negligible number of\n  developers have expressed discomfort with make and the amount of\n  required knowledge to master make seems way higher than what you\n  need to use Dune.\n\n- lack of flexibility: indeed, Dune is way less flexible than\n  make. Dune only knows how to do well two things: building OCaml\n  executables and libraries. However, that is basically 99% of what\n  building Coq entails; building other parts [documentation or Coq\n  libraries] is fairly straightforward and seem to pose not a problem.\n\n- lack of maturity: indeed, Dune develops fast, it is not free of\n  bugs, and some amount of adaptation is expected from us. This risk\n  can only be mitigated if there is continued developer interest.  In\n  the worst case, Coq could become stuck in a particular Dune version.\n\n- bootstrapping: this is not a problem as witnessed by #8615, Dune can\n  be bootstrapped very easily as it depends only on OCaml and it is\n  designed to do so.\n","author_name":"Emilio Jesus Gallego Arias","author_email":"e+git@x80.org","authored_date":"2018-10-15T18:05:29.000+02:00","committer_name":"Emilio Jesus Gallego Arias","committer_email":"e+git@x80.org","committed_date":"2020-03-08T05:22:47.000-04:00","trailers":{},"web_url":"https://gitlab.com/coq/coq/-/commit/f59d7939930e057ea5fa6b406418987f189e7dda"},"pipeline":{"id":124282178,"iid":14269,"project_id":6138686,"sha":"f59d7939930e057ea5fa6b406418987f189e7dda","ref":"pr-8729","status":"failed","source":"push","created_at":"2020-03-08T09:23:01.226Z","updated_at":"2020-03-08T11:48:24.319Z","web_url":"https://gitlab.com/coq/coq/-/pipelines/124282178"},"web_url":"https://gitlab.com/coq/coq/-/jobs/463498067","artifacts":[{"file_type":"trace","size":797203,"filename":"job.log","file_format":null}],"runner":null,"artifacts_expire_at":"2020-03-15T09:37:10.064Z","tag_list":[]}
